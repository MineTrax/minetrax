import{_ as R}from"./AdminLayout-DdnXiWbQ.js";import{u as S}from"./useAuthorizable-jSLZg7XL.js";import{u as N}from"./BaseLayout-B3-iVEMv.js";import{h as D,y as P,z as A,c as h,w as d,s as V,o as a,b as i,j as e,a as s,v as c,P as v,i as u,t,g as b,d as n,K as $}from"./app-D9GuHpcZ.js";import{_ as B}from"./DataTable-CargCGHc.js";import{D as m}from"./DtRowItem-ClEJpXXp.js";import{_ as O}from"./AppBreadcrumb-6YgoLuD3.js";import{_ as Q}from"./index-B5if8pRS.js";import{_ as T}from"./CommonStatusBadge-BMXKPmpH.js";import{a as F}from"./DialogModal-Byh8bXVr.js";import{_ as H}from"./SecondaryButton-HVQGoGPl.js";import{_ as L}from"./UserDisplayname-BVzyzniK.js";import{r as U}from"./EyeIcon-6uoja94i.js";import{r as z}from"./ArrowPathIcon-M-WRxqtF.js";import{r as K}from"./TrashIcon-CpTPbmZd.js";import"./CloudArrowDownIcon-COtJdbQg.js";import"./index-CybQGOSJ.js";import"./utils-D-KgF5mV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-DCyQcqwq.js";import"./useForwardPropsEmits-Ci0C5-5c.js";import"./chevron-down-BRQ4-0aA.js";import"./Teleport-Ck1GoC8n.js";import"./VisuallyHidden-bdJjphAo.js";import"./x-ChK5Vw_y.js";import"./SelectValue-D9eI7XgB.js";import"./useFormControl-C0VJqXgZ.js";import"./vue-multiselect.esm-BzlgdUyi.js";import"./XMarkIcon-CwP4vCZW.js";const M={class:"px-10 py-8 mx-auto text-foreground"},G={class:"flex justify-between mb-4"},J={class:"flex"},W={class:"px-4 py-4 text-sm font-medium text-foreground whitespace-nowrap dark:text-foreground"},X=["title"],Y={key:1,class:"text-foreground italic"},Z={class:"text-xs dark:text-foreground"},ee=["title"],te={key:1,class:"text-foreground italic"},se={key:0,class:"text-foreground dark:text-foreground"},oe={key:1,class:"text-error-500 italic"},ae={key:1,class:"italic text-foreground"},re=["title"],le={key:1,class:"italic"},ne=["title"],de={class:"px-6 py-4 space-x-2 text-sm font-medium text-right whitespace-nowrap"},ie=["onClick","title"],ce={class:"text-lg font-bold"},ue={class:"w-full text-sm grid-cols-2 gap-6 leading-7 md:col-span-2 md:grid"},_e={class:"col-span-2"},me={class:"font-semibold text-foreground"},fe={class:"col-span-2"},pe={class:"font-semibold text-foreground"},he={key:0},xe={key:1,class:"italic text-foreground"},ye={class:"font-semibold text-foreground"},ge={class:""},ve={class:"font-semibold text-foreground"},ke={key:0},be={key:1,class:"italic text-foreground"},we={class:"font-semibold text-foreground"},Ce={class:""},De={class:"font-semibold text-foreground"},Ae={class:"font-semibold text-foreground"},$e={class:"flex items-center"},Te=["title"],je={key:1,class:"text-foreground italic"},qe={class:"text-sm"},Ee={class:"font-semibold text-foreground"},Ie={class:"flex items-center"},Re=["title"],Se={key:1,class:"text-foreground italic"},Ne={class:"font-semibold text-foreground"},Pe={key:0,class:"flex items-center"},Ve={class:"flex-shrink-0 w-8 h-8"},Be=["src"],Oe={class:"ml-2"},Qe={key:0,class:"font-extrabold text-foreground dark:text-foreground"},Fe={key:1,class:"italic text-error-500"},He={key:1,class:"italic text-foreground"},Le={class:"font-semibold text-foreground"},Ue={key:0,class:"flex items-center"},ze={key:1,class:"italic text-foreground"},Ke={class:"font-semibold text-foreground"},Me={class:""},Ge={class:"font-semibold text-foreground"},Je={class:"flex items-center"},We=["title"],Xe={class:"col-span-2"},Ye={class:"font-semibold text-foreground"},Ze={key:0},et={key:1,class:"italic text-foreground"},Et={__name:"IndexCommandQueue",props:{commandQueues:Object,filters:Object},setup(w){const{can:k}=S(),{__:o}=V(),{formatTimeAgoToNow:x,formatToDayDateString:y}=N(),j=[{text:o("Admin"),current:!1},{text:o("Command History"),current:!0}],q=[{key:"id",label:o("ID"),sortable:!0},{key:"parsed_command",label:o("Command"),sortable:!0,filterable:{type:"text"}},{key:"server_id",sortable:!0,label:o("Server"),filterable:{key:"server.name",type:"text"}},{key:"status",label:o("Status"),sortable:!0,filterable:{type:"multiselect",options:["pending","running","failed","cancelled","deferred","completed"]}},{key:"last_attempt_at",sortable:!0,label:o("Last Attempted"),class:"whitespace-nowrap"},{key:"execute_at",sortable:!0,label:o("Execute At"),class:"whitespace-nowrap"},{key:"tag",sortable:!0,label:o("Tags"),filterable:{type:"text"}},{key:"player_id",sortable:!0,label:o("For Player"),class:"whitespace-nowrap",filterable:{key:"player.username",type:"text"}},{key:"output",label:o("Output"),sortable:!0,filterable:{type:"text"}},{key:"created_at",sortable:!0,label:o("Created"),class:"whitespace-nowrap"},{key:"actions",label:o("Actions"),sortable:!1,class:"w-1/12 text-right"}];let f=D(!1),l=D({});const E=p=>{l.value=p,f.value=!0};return(p,g)=>{const I=P("app-head"),C=A("confirm"),_=A("tippy");return a(),h(R,null,{default:d(()=>[i(I,{title:e(o)("Command History")},null,8,["title"]),s("div",M,[s("div",G,[i(O,{class:"mt-0","breadcrumb-class":"max-w-none px-0 md:px-0",items:j}),s("div",J,[e(k)("create command_queues")?(a(),h(e(Q),{key:0,"as-child":""},{default:d(()=>[c((a(),h(e(v),{href:p.route("admin.command-queue.retry"),method:"post",as:"button"},{default:d(()=>[u(t(e(o)("Retry All Failed")),1)]),_:1},8,["href"])),[[C,{message:"Are you sure you wanna retry all failed & cancelled command queues? Please note that failed commands automatically get retried till they reach the max attempts."}]])]),_:1})):b("",!0)])]),i(B,{class:"bg-card rounded-lg shadow",header:q,data:w.commandQueues,filters:w.filters},{default:d(({item:r})=>[s("td",W,t(r.id),1),i(m,{class:"text-left font-mono"},{default:d(()=>[u(t(r.parsed_command),1)]),_:2},1024),i(m,{class:"text-left whitespace-nowrap"},{default:d(()=>[u(t(r.server.name),1)]),_:2},1024),i(m,{class:"text-left"},{default:d(()=>[i(T,{status:r.status.value},null,8,["status"])]),_:2},1024),i(m,null,{default:d(()=>[r.last_attempt_at?c((a(),n("div",{key:0,class:"whitespace-nowrap",title:e(y)(r.last_attempt_at)},[u(t(e(x)(r.last_attempt_at)),1)],8,X)),[[_]]):(a(),n("div",Y,t("not yet"))),s("div",Z,t(e(o)("Attempts: :attempts/:max_attempts",{attempts:r.attempts,max_attempts:r.max_attempts??1})),1)]),_:2},1024),i(m,null,{default:d(()=>[r.execute_at?c((a(),n("div",{key:0,class:"text-sm font-medium text-foreground dark:text-foreground whitespace-nowrap",title:e(y)(r.execute_at)},[u(t(e(x)(r.execute_at)),1)],8,ee)),[[_]]):(a(),n("div",te,t("no delay")))]),_:2},1024),i(m,{class:"text-left"},{default:d(()=>[u(t(r.tag??e(o)("none")),1)]),_:2},1024),i(m,{class:"text-center"},{default:d(()=>[r.player_id?c((a(),h(e(v),{key:0,as:"a",href:p.route("player.show",r.player.uuid),class:"text-sm font-medium text-foreground dark:text-foreground focus:outline-none cursor-pointer hover:underline",content:r.player.uuid},{default:d(()=>[r.player.username?(a(),n("span",se,t(r.player.username),1)):(a(),n("span",oe,t(e(o)("Unknown")),1))]),_:2},1032,["href","content"])),[[_]]):(a(),n("div",ae,t(e(o)("none")),1))]),_:2},1024),i(m,{class:"text-left"},{default:d(()=>[r.output?(a(),n("span",{key:0,class:"truncate",title:r.output},t(r.output.length>10?r.output.substring(0,10)+"...":r.output),9,re)):(a(),n("span",le,t(e(o)("none")),1))]),_:2},1024),i(m,null,{default:d(()=>[c((a(),n("div",{class:"text-sm font-medium text-foreground dark:text-foreground whitespace-nowrap",title:e(y)(r.created_at)},[u(t(e(x)(r.created_at)),1)],8,ne)),[[_]])]),_:2},1024),s("td",de,[c((a(),n("button",{onClick:tt=>E(r),class:"inline-flex items-center justify-center text-primary hover:text-primary",title:e(o)("View Details")},[i(e(U),{class:"inline-block w-5 h-5"})],8,ie)),[[_]]),e(k)("create command_queues")&&["failed","cancelled"].includes(r.status.value)?c((a(),h(e(v),{key:0,as:"button",method:"post",data:{id:r.id},href:p.route("admin.command-queue.retry"),class:"inline-flex items-center justify-center text-success-600 dark:text-success-500 hover:text-success-800 dark:hover:text-success-800",title:e(o)("Retry Command")},{default:d(()=>[i(e(z),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[_]]):b("",!0),e(k)("delete command_queues")&&["pending","failed","cancelled","completed","deferred"].includes(r.status.value)?c((a(),h(e(v),{key:1,as:"button",method:"DELETE",data:{id:r.id},href:p.route("admin.command-queue.delete"),class:"inline-flex items-center justify-center text-error-600 hover:text-error-900 focus:outline-none",title:e(o)("Delete Command")},{default:d(()=>[i(e(K),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[C,{message:"Are you sure you want to delete this command history?"}],[_]]):b("",!0)])]),_:1},8,["data","filters"])]),i(F,{show:e(f),onClose:g[1]||(g[1]=r=>$(f)?f.value=!1:f=!1)},{title:d(()=>[s("h3",ce,t(e(o)("Run Details")),1)]),content:d(()=>[s("div",ue,[s("div",_e,[s("p",me,t(e(o)("Command")),1),s("code",null,t(e(l).parsed_command),1)]),s("div",fe,[s("p",pe,t(e(o)("Output")),1),e(l).output?(a(),n("code",he,t(e(l).output),1)):(a(),n("div",xe,t(e(o)("none")),1))]),s("div",null,[s("p",ye,t(e(o)("ID")),1),s("p",ge,t(e(l).id),1)]),s("div",null,[s("p",ve,t(e(o)("Command ID")),1),e(l).command_id?(a(),n("p",ke,t(e(l).command_id),1)):(a(),n("p",be,t(e(o)("none")),1))]),s("div",null,[s("p",we,t(e(o)("Server")),1),s("p",Ce,t(e(l).server.name),1)]),s("div",null,[s("p",De,t(e(o)("Status")),1),i(T,{status:e(l).status.value},null,8,["status"])]),s("div",null,[s("p",Ae,t(e(o)("Last Attempted")),1),s("div",$e,[e(l).last_attempt_at?c((a(),n("div",{key:0,class:"whitespace-nowrap",title:e(y)(e(l).last_attempt_at)},[u(t(e(x)(e(l).last_attempt_at)),1)],8,Te)),[[_]]):(a(),n("div",je,t("not yet"))),g[2]||(g[2]=u("  ●  ")),s("div",qe,t(e(o)("Attempts: :attempts/:max_attempts",{attempts:e(l).attempts,max_attempts:e(l).max_attempts??1})),1)])]),s("div",null,[s("p",Ee,t(e(o)("Execute At")),1),s("div",Ie,[e(l).execute_at?c((a(),n("div",{key:0,class:"text-sm font-medium text-foreground dark:text-foreground whitespace-nowrap",title:e(y)(e(l).execute_at)},[u(t(e(x)(e(l).execute_at)),1)],8,Re)),[[_]]):(a(),n("div",Se,t("no delay")))])]),s("div",null,[s("p",Ne,t(e(o)("For Player")),1),s("div",null,[e(l).player_id?(a(),n("div",Pe,[s("div",Ve,[s("img",{class:"w-8 h-8",src:e(l).player.avatar_url,alt:""},null,8,Be)]),s("div",Oe,[c((a(),h(e(v),{as:"a",href:p.route("player.show",e(l).player.uuid),class:"font-medium text-foreground cursor-pointer dark:text-foreground focus:outline-none hover:underline",content:e(l).player.uuid},{default:d(()=>[e(l).player.username?(a(),n("span",Qe,t(e(l).player.username),1)):(a(),n("span",Fe,t(e(o)("Unknown")),1))]),_:1},8,["href","content"])),[[_]])])])):(a(),n("div",He,t(e(o)("none")),1))])]),s("div",null,[s("p",Le,t(e(o)("User")),1),s("div",null,[e(l).user_id?(a(),n("div",Ue,[i(e(v),{href:p.route("user.public.get",e(l).user.username)},{default:d(()=>[i(L,{user:e(l).user,"icon-class":"w-4 h-4","text-class":"text-sm"},null,8,["user"])]),_:1},8,["href"])])):(a(),n("div",ze,t(e(o)("none")),1))])]),s("div",null,[s("p",Ke,t(e(o)("Tags")),1),s("p",Me,t(e(l).tag??e(o)("none")),1)]),s("div",null,[s("p",Ge,t(e(o)("Created At")),1),s("div",Je,[c((a(),n("div",{class:"text-sm font-medium text-foreground dark:text-foreground whitespace-nowrap",title:e(y)(e(l).created_at)},[u(t(e(x)(e(l).created_at)),1)],8,We)),[[_]])])]),s("div",Xe,[s("p",Ye,t(e(o)("Config")),1),e(l).config?(a(),n("code",Ze,t(e(l).config),1)):(a(),n("div",et,t(e(o)("none")),1))])])]),footer:d(()=>[i(H,{onClick:g[0]||(g[0]=r=>$(f)?f.value=!1:f=!1)},{default:d(()=>[u(t(e(o)("Close")),1)]),_:1})]),_:1},8,["show"])]),_:1})}}};export{Et as default};
