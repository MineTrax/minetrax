import{_ as L}from"./AdminLayout-BoKh1YjX.js";import{u as N}from"./useAuthorizable-1fkLwajf.js";import{u as P}from"./AppLayout-eDmNAsPw.js";import{r as A,q as b,y as $,c as g,w as i,p as V,o as l,b as d,u as t,a as s,t as e,m as c,f as u,e as w,d as r,P as q,J as T}from"./app-_ki-Ar5w.js";import{_ as B}from"./DataTable-SccKRBRi.js";import{D as m}from"./DtRowItem-CMMh99dr.js";import{_ as I}from"./CommonStatusBadge-BYHMhe2K.js";import{_ as O}from"./DialogModal-D3RiCASk.js";import{_ as Q}from"./SecondaryButton-Nx4xDsxQ.js";import{_ as F}from"./UserDisplayname-CcvkvXsh.js";import{r as H}from"./EyeIcon-DGKmWCoN.js";import{r as U}from"./ArrowPathIcon-BJr_uufv.js";import{r as z}from"./TrashIcon-C52-WTTU.js";import"./keyboard-BEzvmP1D.js";import"./open-closed-CrutJkQn.js";import"./CloudArrowDownIcon-BS1KhqYM.js";import"./index-CZsT1EYE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-C1ozQT9U.js";import"./vue-multiselect.esm-BRZ6v-65.js";import"./XMarkIcon-CVj17J4w.js";import"./hidden-nRc2_VCu.js";import"./Modal-zPf4Ty0C.js";const J={class:"px-10 py-8 mx-auto text-gray-400"},M={class:"flex justify-between mb-4"},G={class:"text-3xl font-bold text-gray-500 dark:text-gray-300"},K={class:"flex"},W={class:"px-4 py-4 text-sm font-medium text-gray-800 whitespace-nowrap dark:text-gray-200"},X=["title"],Y={key:1,class:"text-gray-500 italic"},Z={class:"text-xs dark:text-gray-500"},tt=["title"],et={key:1,class:"text-gray-500 italic"},st={key:0,class:"text-gray-600 dark:text-gray-400"},at={key:1,class:"text-red-500 italic"},ot={key:1,class:"italic text-gray-500"},lt=["title"],nt={key:1,class:"italic"},rt=["title"],it={class:"px-6 py-4 space-x-2 text-sm font-medium text-right whitespace-nowrap"},dt=["onClick","title"],ct={class:"text-lg font-bold"},ut={class:"w-full text-sm grid-cols-2 gap-6 leading-7 md:col-span-2 md:grid"},_t={class:"col-span-2"},mt={class:"font-semibold text-gray-500"},pt={class:"col-span-2"},ft={class:"font-semibold text-gray-500"},yt={key:0},ht={key:1,class:"italic text-gray-500"},xt={class:"font-semibold text-gray-500"},gt={class:""},vt={class:"font-semibold text-gray-500"},kt={class:""},bt={class:"font-semibold text-gray-500"},wt={class:""},Ct={class:"font-semibold text-gray-500"},Dt={class:"font-semibold text-gray-500"},At={class:"flex items-center"},$t=["title"],qt={key:1,class:"text-gray-500 italic"},Tt={class:"text-sm"},It={class:"font-semibold text-gray-500"},jt={class:"flex items-center"},Et=["title"],Rt={key:1,class:"text-gray-500 italic"},St={class:"font-semibold text-gray-500"},Lt={key:0,class:"flex items-center"},Nt={class:"flex-shrink-0 w-8 h-8"},Pt=["src"],Vt={class:"ml-2"},Bt={key:0,class:"font-extrabold text-gray-700 dark:text-gray-300"},Ot={key:1,class:"italic text-red-500"},Qt={key:1,class:"italic text-gray-500"},Ft={class:"font-semibold text-gray-500"},Ht={key:0,class:"flex items-center"},Ut={key:1,class:"italic text-gray-500"},zt={class:"font-semibold text-gray-500"},Jt={class:""},Mt={class:"font-semibold text-gray-500"},Gt={class:"flex items-center"},Kt=["title"],Wt={class:"col-span-2"},Xt={class:"font-semibold text-gray-500"},Yt={key:0},Zt={key:1,class:"italic text-gray-500"},Ce={__name:"IndexCommandQueue",props:{commandQueues:Object,filters:Object},setup(C){const{can:v}=N(),{__:a}=V(),{formatTimeAgoToNow:y,formatToDayDateString:h}=P(),j=[{key:"id",label:a("ID"),sortable:!0},{key:"parsed_command",label:a("Command"),sortable:!0,filterable:{type:"text"}},{key:"server_id",sortable:!0,label:a("Server"),filterable:{key:"server.name",type:"text"}},{key:"status",label:a("Status"),sortable:!0,filterable:{type:"multiselect",options:["pending","running","failed","cancelled","deferred","completed"]}},{key:"last_attempt_at",sortable:!0,label:a("Last Attempted"),class:"whitespace-nowrap"},{key:"execute_at",sortable:!0,label:a("Execute At"),class:"whitespace-nowrap"},{key:"tag",sortable:!0,label:a("Tags"),filterable:{type:"text"}},{key:"player_id",sortable:!0,label:a("For Player"),class:"whitespace-nowrap",filterable:{key:"player.username",type:"text"}},{key:"output",label:a("Output"),sortable:!0,filterable:{type:"text"}},{key:"created_at",sortable:!0,label:a("Created"),class:"whitespace-nowrap"},{key:"actions",label:a("Actions"),sortable:!1,class:"w-1/12 text-right"}];let p=A(!1),n=A({});const E=f=>{n.value=f,p.value=!0};return(f,x)=>{const R=b("app-head"),k=b("InertiaLink"),S=b("inertia-link"),D=$("confirm"),_=$("tippy");return l(),g(L,null,{default:i(()=>[d(R,{title:t(a)("Command History")},null,8,["title"]),s("div",J,[s("div",M,[s("h1",G,e(t(a)("Command History")),1),s("div",K,[t(v)("create command_queues")?c((l(),g(k,{key:0,href:f.route("admin.command-queue.retry"),method:"post",as:"button",class:"mr-2 inline-flex items-center px-4 py-2 text-xs font-semibold tracking-widest text-white uppercase transition duration-150 ease-in-out bg-green-500 border border-transparent rounded-md hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:shadow-outline-gray"},{default:i(()=>[u(e(t(a)("Retry All Failed")),1)]),_:1},8,["href"])),[[D,{message:"Are you sure you wanna retry all failed & cancelled command queues? Please note that failed commands automatically get retried till they reach the max attempts."}]]):w("",!0)])]),d(B,{class:"bg-white rounded shadow dark:bg-gray-800",header:j,data:C.commandQueues,filters:C.filters},{default:i(({item:o})=>[s("td",W,e(o.id),1),d(m,{class:"text-left font-mono"},{default:i(()=>[u(e(o.parsed_command),1)]),_:2},1024),d(m,{class:"text-left whitespace-nowrap"},{default:i(()=>[u(e(o.server.name),1)]),_:2},1024),d(m,{class:"text-left"},{default:i(()=>[d(I,{status:o.status.value},null,8,["status"])]),_:2},1024),d(m,null,{default:i(()=>[o.last_attempt_at?c((l(),r("div",{key:0,class:"whitespace-nowrap",title:t(h)(o.last_attempt_at)},[u(e(t(y)(o.last_attempt_at)),1)],8,X)),[[_]]):(l(),r("div",Y,e("not yet"))),s("div",Z,e(t(a)("Attempts: :attempts/:max_attempts",{attempts:o.attempts,max_attempts:o.max_attempts??1})),1)]),_:2},1024),d(m,null,{default:i(()=>[o.execute_at?c((l(),r("div",{key:0,class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(o.execute_at)},[u(e(t(y)(o.execute_at)),1)],8,tt)),[[_]]):(l(),r("div",et,e("no delay")))]),_:2},1024),d(m,{class:"text-left"},{default:i(()=>[u(e(o.tag??t(a)("none")),1)]),_:2},1024),d(m,{class:"text-center"},{default:i(()=>[o.player_id?c((l(),g(S,{key:0,as:"a",href:f.route("player.show",o.player.uuid),class:"text-sm font-medium text-gray-900 dark:text-gray-400 focus:outline-none cursor-pointer hover:underline",content:o.player.uuid},{default:i(()=>[o.player.username?(l(),r("span",st,e(o.player.username),1)):(l(),r("span",at,e(t(a)("Unknown")),1))]),_:2},1032,["href","content"])),[[_]]):(l(),r("div",ot,e(t(a)("none")),1))]),_:2},1024),d(m,{class:"text-left"},{default:i(()=>[o.output?(l(),r("span",{key:0,class:"truncate",title:o.output},e(o.output.length>10?o.output.substring(0,10)+"...":o.output),9,lt)):(l(),r("span",nt,e(t(a)("none")),1))]),_:2},1024),d(m,null,{default:i(()=>[c((l(),r("div",{class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(o.created_at)},[u(e(t(y)(o.created_at)),1)],8,rt)),[[_]])]),_:2},1024),s("td",it,[c((l(),r("button",{onClick:te=>E(o),class:"inline-flex items-center justify-center text-blue-500 hover:text-blue-800",title:t(a)("View Details")},[d(t(H),{class:"inline-block w-5 h-5"})],8,dt)),[[_]]),t(v)("create command_queues")&&["failed","cancelled"].includes(o.status.value)?c((l(),g(k,{key:0,as:"button",method:"post",data:{id:o.id},href:f.route("admin.command-queue.retry"),class:"inline-flex items-center justify-center text-green-600 dark:text-green-500 hover:text-green-800 dark:hover:text-green-800",title:t(a)("Retry Command")},{default:i(()=>[d(t(U),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[_]]):w("",!0),t(v)("delete command_queues")&&["pending","failed","cancelled","completed","deferred"].includes(o.status.value)?c((l(),g(k,{key:1,as:"button",method:"DELETE",data:{id:o.id},href:f.route("admin.command-queue.delete"),class:"inline-flex items-center justify-center text-red-600 hover:text-red-900 focus:outline-none",title:t(a)("Delete Command")},{default:i(()=>[d(t(z),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[D,{message:"Are you sure you want to delete this command history?"}],[_]]):w("",!0)])]),_:1},8,["data","filters"])]),d(O,{show:t(p),onClose:x[1]||(x[1]=o=>T(p)?p.value=!1:p=!1)},{title:i(()=>[s("h3",ct,e(t(a)("Run Details")),1)]),content:i(()=>[s("div",ut,[s("div",_t,[s("p",mt,e(t(a)("Command")),1),s("code",null,e(t(n).parsed_command),1)]),s("div",pt,[s("p",ft,e(t(a)("Output")),1),t(n).output?(l(),r("code",yt,e(t(n).output),1)):(l(),r("div",ht,e(t(a)("none")),1))]),s("div",null,[s("p",xt,e(t(a)("ID")),1),s("p",gt,e(t(n).id),1)]),s("div",null,[s("p",vt,e(t(a)("Command ID")),1),s("p",kt,e(t(n).command_id),1)]),s("div",null,[s("p",bt,e(t(a)("Server")),1),s("p",wt,e(t(n).server.name),1)]),s("div",null,[s("p",Ct,e(t(a)("Status")),1),d(I,{status:t(n).status.value},null,8,["status"])]),s("div",null,[s("p",Dt,e(t(a)("Last Attempted")),1),s("div",At,[t(n).last_attempt_at?c((l(),r("div",{key:0,class:"whitespace-nowrap",title:t(h)(t(n).last_attempt_at)},[u(e(t(y)(t(n).last_attempt_at)),1)],8,$t)),[[_]]):(l(),r("div",qt,e("not yet"))),x[2]||(x[2]=u("  ●  ")),s("div",Tt,e(t(a)("Attempts: :attempts/:max_attempts",{attempts:t(n).attempts,max_attempts:t(n).max_attempts??1})),1)])]),s("div",null,[s("p",It,e(t(a)("Execute At")),1),s("div",jt,[t(n).execute_at?c((l(),r("div",{key:0,class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(t(n).execute_at)},[u(e(t(y)(t(n).execute_at)),1)],8,Et)),[[_]]):(l(),r("div",Rt,e("no delay")))])]),s("div",null,[s("p",St,e(t(a)("For Player")),1),s("div",null,[t(n).player_id?(l(),r("div",Lt,[s("div",Nt,[s("img",{class:"w-8 h-8",src:t(n).player.avatar_url,alt:""},null,8,Pt)]),s("div",Vt,[c((l(),g(t(q),{as:"a",href:f.route("player.show",t(n).player.uuid),class:"font-medium text-gray-900 cursor-pointer dark:text-gray-200 focus:outline-none hover:underline",content:t(n).player.uuid},{default:i(()=>[t(n).player.username?(l(),r("span",Bt,e(t(n).player.username),1)):(l(),r("span",Ot,e(t(a)("Unknown")),1))]),_:1},8,["href","content"])),[[_]])])])):(l(),r("div",Qt,e(t(a)("none")),1))])]),s("div",null,[s("p",Ft,e(t(a)("User")),1),s("div",null,[t(n).user_id?(l(),r("div",Ht,[d(t(q),{href:f.route("user.public.get",t(n).user.username)},{default:i(()=>[d(F,{user:t(n).user,"icon-class":"w-4 h-4","text-class":"text-sm"},null,8,["user"])]),_:1},8,["href"])])):(l(),r("div",Ut,e(t(a)("none")),1))])]),s("div",null,[s("p",zt,e(t(a)("Tags")),1),s("p",Jt,e(t(n).tag??t(a)("none")),1)]),s("div",null,[s("p",Mt,e(t(a)("Created At")),1),s("div",Gt,[c((l(),r("div",{class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(t(n).created_at)},[u(e(t(y)(t(n).created_at)),1)],8,Kt)),[[_]])])]),s("div",Wt,[s("p",Xt,e(t(a)("Config")),1),t(n).config?(l(),r("code",Yt,e(t(n).config),1)):(l(),r("div",Zt,e(t(a)("none")),1))])])]),footer:i(()=>[d(Q,{onClick:x[0]||(x[0]=o=>T(p)?p.value=!1:p=!1)},{default:i(()=>[u(e(t(a)("Close")),1)]),_:1})]),_:1},8,["show"])]),_:1})}}};export{Ce as default};
