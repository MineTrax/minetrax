import{_ as L}from"./AdminLayout-DPBDMACk.js";import{u as N}from"./useAuthorizable-EXRySIfj.js";import{u as P}from"./AppLayout-Bad1xh2T.js";import{r as A,s as b,z as $,c as g,w as i,q as V,o,b as d,u as t,a as s,t as e,p as c,f as u,e as w,d as r,P as q,J as T}from"./app-Cue287CJ.js";import{_ as B}from"./DataTable-jY5BhpAe.js";import{D as m}from"./DtRowItem-D45ZMqHh.js";import{_ as I}from"./CommonStatusBadge-B92s-TWG.js";import{_ as O}from"./DialogModal-CPc_FgmV.js";import{_ as Q}from"./SecondaryButton-C_9AKTk_.js";import{_ as F}from"./UserDisplayname-Hg9QtbqE.js";import{r as H}from"./EyeIcon-_8z0bz2k.js";import{r as U}from"./ArrowPathIcon-CGZZOikO.js";import{r as z}from"./TrashIcon-D8UkcIbU.js";import"./keyboard-BHhOTWdc.js";import"./open-closed-4H-Jyfu8.js";import"./CloudArrowDownIcon-BgRljXhv.js";import"./index-IwP16JBD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-BRyGKuy3.js";import"./vue-multiselect.esm-D0oDpaBR.js";import"./XMarkIcon-D4-JWr79.js";import"./hidden-CPHkDd5q.js";import"./Modal-D-TuPrhi.js";const J={class:"px-10 py-8 mx-auto text-gray-400"},M={class:"flex justify-between mb-4"},G={class:"text-3xl font-bold text-gray-500 dark:text-gray-300"},K={class:"flex"},W={class:"px-4 py-4 text-sm font-medium text-gray-800 whitespace-nowrap dark:text-gray-200"},X=["title"],Y={key:1,class:"text-gray-500 italic"},Z={class:"text-xs dark:text-gray-500"},tt=["title"],et={key:1,class:"text-gray-500 italic"},st={key:0,class:"text-gray-600 dark:text-gray-400"},at={key:1,class:"text-red-500 italic"},ot={key:1,class:"italic text-gray-500"},lt=["title"],nt={key:1,class:"italic"},rt=["title"],it={class:"px-6 py-4 space-x-2 text-sm font-medium text-right whitespace-nowrap"},dt=["onClick","title"],ct={class:"text-lg font-bold"},ut={class:"w-full text-sm grid-cols-2 gap-6 leading-7 md:col-span-2 md:grid"},_t={class:"col-span-2"},mt={class:"font-semibold text-gray-500"},pt={class:"col-span-2"},yt={class:"font-semibold text-gray-500"},ft={key:0},ht={key:1,class:"italic text-gray-500"},xt={class:"font-semibold text-gray-500"},gt={class:""},vt={class:"font-semibold text-gray-500"},kt={key:0},bt={key:1,class:"italic text-gray-500"},wt={class:"font-semibold text-gray-500"},Ct={class:""},Dt={class:"font-semibold text-gray-500"},At={class:"font-semibold text-gray-500"},$t={class:"flex items-center"},qt=["title"],Tt={key:1,class:"text-gray-500 italic"},It={class:"text-sm"},jt={class:"font-semibold text-gray-500"},Et={class:"flex items-center"},Rt=["title"],St={key:1,class:"text-gray-500 italic"},Lt={class:"font-semibold text-gray-500"},Nt={key:0,class:"flex items-center"},Pt={class:"flex-shrink-0 w-8 h-8"},Vt=["src"],Bt={class:"ml-2"},Ot={key:0,class:"font-extrabold text-gray-700 dark:text-gray-300"},Qt={key:1,class:"italic text-red-500"},Ft={key:1,class:"italic text-gray-500"},Ht={class:"font-semibold text-gray-500"},Ut={key:0,class:"flex items-center"},zt={key:1,class:"italic text-gray-500"},Jt={class:"font-semibold text-gray-500"},Mt={class:""},Gt={class:"font-semibold text-gray-500"},Kt={class:"flex items-center"},Wt=["title"],Xt={class:"col-span-2"},Yt={class:"font-semibold text-gray-500"},Zt={key:0},te={key:1,class:"italic text-gray-500"},De={__name:"IndexCommandQueue",props:{commandQueues:Object,filters:Object},setup(C){const{can:v}=N(),{__:a}=V(),{formatTimeAgoToNow:f,formatToDayDateString:h}=P(),j=[{key:"id",label:a("ID"),sortable:!0},{key:"parsed_command",label:a("Command"),sortable:!0,filterable:{type:"text"}},{key:"server_id",sortable:!0,label:a("Server"),filterable:{key:"server.name",type:"text"}},{key:"status",label:a("Status"),sortable:!0,filterable:{type:"multiselect",options:["pending","running","failed","cancelled","deferred","completed"]}},{key:"last_attempt_at",sortable:!0,label:a("Last Attempted"),class:"whitespace-nowrap"},{key:"execute_at",sortable:!0,label:a("Execute At"),class:"whitespace-nowrap"},{key:"tag",sortable:!0,label:a("Tags"),filterable:{type:"text"}},{key:"player_id",sortable:!0,label:a("For Player"),class:"whitespace-nowrap",filterable:{key:"player.username",type:"text"}},{key:"output",label:a("Output"),sortable:!0,filterable:{type:"text"}},{key:"created_at",sortable:!0,label:a("Created"),class:"whitespace-nowrap"},{key:"actions",label:a("Actions"),sortable:!1,class:"w-1/12 text-right"}];let p=A(!1),n=A({});const E=y=>{n.value=y,p.value=!0};return(y,x)=>{const R=b("app-head"),k=b("InertiaLink"),S=b("inertia-link"),D=$("confirm"),_=$("tippy");return o(),g(L,null,{default:i(()=>[d(R,{title:t(a)("Command History")},null,8,["title"]),s("div",J,[s("div",M,[s("h1",G,e(t(a)("Command History")),1),s("div",K,[t(v)("create command_queues")?c((o(),g(k,{key:0,href:y.route("admin.command-queue.retry"),method:"post",as:"button",class:"mr-2 inline-flex items-center px-4 py-2 text-xs font-semibold tracking-widest text-white uppercase transition duration-150 ease-in-out bg-green-500 border border-transparent rounded-md hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:shadow-outline-gray"},{default:i(()=>[u(e(t(a)("Retry All Failed")),1)]),_:1},8,["href"])),[[D,{message:"Are you sure you wanna retry all failed & cancelled command queues? Please note that failed commands automatically get retried till they reach the max attempts."}]]):w("",!0)])]),d(B,{class:"bg-white rounded shadow dark:bg-gray-800",header:j,data:C.commandQueues,filters:C.filters},{default:i(({item:l})=>[s("td",W,e(l.id),1),d(m,{class:"text-left font-mono"},{default:i(()=>[u(e(l.parsed_command),1)]),_:2},1024),d(m,{class:"text-left whitespace-nowrap"},{default:i(()=>[u(e(l.server.name),1)]),_:2},1024),d(m,{class:"text-left"},{default:i(()=>[d(I,{status:l.status.value},null,8,["status"])]),_:2},1024),d(m,null,{default:i(()=>[l.last_attempt_at?c((o(),r("div",{key:0,class:"whitespace-nowrap",title:t(h)(l.last_attempt_at)},[u(e(t(f)(l.last_attempt_at)),1)],8,X)),[[_]]):(o(),r("div",Y,e("not yet"))),s("div",Z,e(t(a)("Attempts: :attempts/:max_attempts",{attempts:l.attempts,max_attempts:l.max_attempts??1})),1)]),_:2},1024),d(m,null,{default:i(()=>[l.execute_at?c((o(),r("div",{key:0,class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(l.execute_at)},[u(e(t(f)(l.execute_at)),1)],8,tt)),[[_]]):(o(),r("div",et,e("no delay")))]),_:2},1024),d(m,{class:"text-left"},{default:i(()=>[u(e(l.tag??t(a)("none")),1)]),_:2},1024),d(m,{class:"text-center"},{default:i(()=>[l.player_id?c((o(),g(S,{key:0,as:"a",href:y.route("player.show",l.player.uuid),class:"text-sm font-medium text-gray-900 dark:text-gray-400 focus:outline-none cursor-pointer hover:underline",content:l.player.uuid},{default:i(()=>[l.player.username?(o(),r("span",st,e(l.player.username),1)):(o(),r("span",at,e(t(a)("Unknown")),1))]),_:2},1032,["href","content"])),[[_]]):(o(),r("div",ot,e(t(a)("none")),1))]),_:2},1024),d(m,{class:"text-left"},{default:i(()=>[l.output?(o(),r("span",{key:0,class:"truncate",title:l.output},e(l.output.length>10?l.output.substring(0,10)+"...":l.output),9,lt)):(o(),r("span",nt,e(t(a)("none")),1))]),_:2},1024),d(m,null,{default:i(()=>[c((o(),r("div",{class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(l.created_at)},[u(e(t(f)(l.created_at)),1)],8,rt)),[[_]])]),_:2},1024),s("td",it,[c((o(),r("button",{onClick:ee=>E(l),class:"inline-flex items-center justify-center text-blue-500 hover:text-blue-800",title:t(a)("View Details")},[d(t(H),{class:"inline-block w-5 h-5"})],8,dt)),[[_]]),t(v)("create command_queues")&&["failed","cancelled"].includes(l.status.value)?c((o(),g(k,{key:0,as:"button",method:"post",data:{id:l.id},href:y.route("admin.command-queue.retry"),class:"inline-flex items-center justify-center text-green-600 dark:text-green-500 hover:text-green-800 dark:hover:text-green-800",title:t(a)("Retry Command")},{default:i(()=>[d(t(U),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[_]]):w("",!0),t(v)("delete command_queues")&&["pending","failed","cancelled","completed","deferred"].includes(l.status.value)?c((o(),g(k,{key:1,as:"button",method:"DELETE",data:{id:l.id},href:y.route("admin.command-queue.delete"),class:"inline-flex items-center justify-center text-red-600 hover:text-red-900 focus:outline-none",title:t(a)("Delete Command")},{default:i(()=>[d(t(z),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[D,{message:"Are you sure you want to delete this command history?"}],[_]]):w("",!0)])]),_:1},8,["data","filters"])]),d(O,{show:t(p),onClose:x[1]||(x[1]=l=>T(p)?p.value=!1:p=!1)},{title:i(()=>[s("h3",ct,e(t(a)("Run Details")),1)]),content:i(()=>[s("div",ut,[s("div",_t,[s("p",mt,e(t(a)("Command")),1),s("code",null,e(t(n).parsed_command),1)]),s("div",pt,[s("p",yt,e(t(a)("Output")),1),t(n).output?(o(),r("code",ft,e(t(n).output),1)):(o(),r("div",ht,e(t(a)("none")),1))]),s("div",null,[s("p",xt,e(t(a)("ID")),1),s("p",gt,e(t(n).id),1)]),s("div",null,[s("p",vt,e(t(a)("Command ID")),1),t(n).command_id?(o(),r("p",kt,e(t(n).command_id),1)):(o(),r("p",bt,e(t(a)("none")),1))]),s("div",null,[s("p",wt,e(t(a)("Server")),1),s("p",Ct,e(t(n).server.name),1)]),s("div",null,[s("p",Dt,e(t(a)("Status")),1),d(I,{status:t(n).status.value},null,8,["status"])]),s("div",null,[s("p",At,e(t(a)("Last Attempted")),1),s("div",$t,[t(n).last_attempt_at?c((o(),r("div",{key:0,class:"whitespace-nowrap",title:t(h)(t(n).last_attempt_at)},[u(e(t(f)(t(n).last_attempt_at)),1)],8,qt)),[[_]]):(o(),r("div",Tt,e("not yet"))),x[2]||(x[2]=u("  ●  ")),s("div",It,e(t(a)("Attempts: :attempts/:max_attempts",{attempts:t(n).attempts,max_attempts:t(n).max_attempts??1})),1)])]),s("div",null,[s("p",jt,e(t(a)("Execute At")),1),s("div",Et,[t(n).execute_at?c((o(),r("div",{key:0,class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(t(n).execute_at)},[u(e(t(f)(t(n).execute_at)),1)],8,Rt)),[[_]]):(o(),r("div",St,e("no delay")))])]),s("div",null,[s("p",Lt,e(t(a)("For Player")),1),s("div",null,[t(n).player_id?(o(),r("div",Nt,[s("div",Pt,[s("img",{class:"w-8 h-8",src:t(n).player.avatar_url,alt:""},null,8,Vt)]),s("div",Bt,[c((o(),g(t(q),{as:"a",href:y.route("player.show",t(n).player.uuid),class:"font-medium text-gray-900 cursor-pointer dark:text-gray-200 focus:outline-none hover:underline",content:t(n).player.uuid},{default:i(()=>[t(n).player.username?(o(),r("span",Ot,e(t(n).player.username),1)):(o(),r("span",Qt,e(t(a)("Unknown")),1))]),_:1},8,["href","content"])),[[_]])])])):(o(),r("div",Ft,e(t(a)("none")),1))])]),s("div",null,[s("p",Ht,e(t(a)("User")),1),s("div",null,[t(n).user_id?(o(),r("div",Ut,[d(t(q),{href:y.route("user.public.get",t(n).user.username)},{default:i(()=>[d(F,{user:t(n).user,"icon-class":"w-4 h-4","text-class":"text-sm"},null,8,["user"])]),_:1},8,["href"])])):(o(),r("div",zt,e(t(a)("none")),1))])]),s("div",null,[s("p",Jt,e(t(a)("Tags")),1),s("p",Mt,e(t(n).tag??t(a)("none")),1)]),s("div",null,[s("p",Gt,e(t(a)("Created At")),1),s("div",Kt,[c((o(),r("div",{class:"text-sm font-medium text-gray-900 dark:text-gray-300 whitespace-nowrap",title:t(h)(t(n).created_at)},[u(e(t(f)(t(n).created_at)),1)],8,Wt)),[[_]])])]),s("div",Xt,[s("p",Yt,e(t(a)("Config")),1),t(n).config?(o(),r("code",Zt,e(t(n).config),1)):(o(),r("div",te,e(t(a)("none")),1))])])]),footer:i(()=>[d(Q,{onClick:x[0]||(x[0]=l=>T(p)?p.value=!1:p=!1)},{default:i(()=>[u(e(t(a)("Close")),1)]),_:1})]),_:1},8,["show"])]),_:1})}}};export{De as default};
