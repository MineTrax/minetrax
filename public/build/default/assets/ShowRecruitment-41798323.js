import{u as B,A as Y}from"./AppLayout-5fa2c638.js";import{S as F}from"./ServerStatusBox-7e67bbb6.js";import{S as T}from"./ShoutBox-d18c6f86.js";import{r as k,A as H,s as f,o as m,c as h,w as n,b as d,a as o,t as i,u as r,f as p,e as y,d as S,J as R,q,T as N,V as P}from"./app-e2d1b450.js";import{u as K}from"./useFormKit-cc6f0e5f.js";import{_ as x}from"./AlertCard-1fb585a5.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Icon-14807a0c.js";import"./useAuthorizable-6471aaac.js";import"./CopyToClipboard-da0e6391.js";import"./XMarkIcon-84c589b2.js";const M={class:"py-4 px-2 md:py-12 md:px-10 max-w-7xl mx-auto"},O={class:"flex justify-between md:mb-4"},j={class:"text-center font-bold text-2xl text-gray-900 dark:text-gray-200 mb-5"},D={class:""},E={class:"flex flex-col md:flex-row md:space-x-4"},I={class:"overflow-x-auto md:w-9/12"},J={class:"flex mt-2"},U={class:"flex mt-2"},W={class:"min-w-full"},$={class:"shadow max-w-none bg-white dark:bg-cool-gray-800 px-3 py-2 md:px-10 md:py-5 overflow-hidden rounded"},z=["innerHTML"],G={key:1,class:"text-xs text-gray-500 dark:text-gray-400 text-right"},Q={class:"md:w-3/12 flex-1 space-y-4 mt-4 md:mt-0"},le={__name:"ShowRecruitment",props:{recruitment:{type:Object},currentUserCanSubmit:{type:Boolean},userVerified:{type:Boolean},userHasLinkedPlayer:{type:Boolean},userSubmissionsCount:{type:Number},secondsSinceLastSubmission:{type:Number},userLastActiveSubmission:{type:Object},userLastApprovedSubmission:{type:Object}},setup(t){const s=t,{__:e}=q(),{secondsToHMS:w,formatToDayDateString:_}=B(),A=K().generateSchemaFromFieldsArray(s.recruitment.fields),L=async u=>{await C(u)},C=u=>new Promise((b,v)=>{N({...u}).post(route("recruitment.submit",s.recruitment.slug),{onSuccess:c=>{b(c)},onError:c=>{v(c)}})}),l=k({title:null,body:null}),a=k(!1);return H(()=>{var u,b;s.recruitment.status.value!="active"&&(l.value={title:e("Application Closed!"),body:e("This application form is currently closed. Please check back later.")},a.value=!0),(b=(u=P().props)==null?void 0:u.auth)!=null&&b.user||(l.value={title:e("Login or Register to Apply!"),body:e("You need to be logged in to apply to this application.")},a.value=!0),s.userLastActiveSubmission?a.value=!0:s.recruitment.max_submission_per_user&&s.userSubmissionsCount>=s.recruitment.max_submission_per_user?(l.value={title:e("Max Submissions Reached!"),body:e("You have reached the maximum number of submissions for this application.")},a.value=!0):s.recruitment.submission_cooldown_in_seconds&&s.secondsSinceLastSubmission&&s.secondsSinceLastSubmission<s.recruitment.submission_cooldown_in_seconds?(l.value={title:e("You are on a Cooldown!"),body:e("You need to wait :seconds before submitting this application again.",{seconds:w(s.recruitment.submission_cooldown_in_seconds-s.secondsSinceLastSubmission,!0)})},a.value=!0):s.recruitment.is_allow_only_verified_users&&!s.userVerified?(l.value={title:e("Account Verification Required!"),body:e("Only verified users can apply to this application. Please verify your account.")},a.value=!0):s.recruitment.is_allow_only_player_linked_users&&!s.userHasLinkedPlayer&&(l.value={title:e("Account Linking Required!"),body:e("Only users with linked players can apply to this application. Please link a player to your account.")},a.value=!0)}),(u,b)=>{const v=f("app-head"),g=f("inertia-link"),c=f("InertiaLink"),V=f("FormKit");return m(),h(Y,null,{default:n(()=>[d(v,{title:t.recruitment.title},null,8,["title"]),o("div",M,[o("div",O,[o("h1",j,i(t.recruitment.title),1),o("div",D,[d(g,{href:u.route("home"),class:"inline-flex items-center px-4 py-2 bg-gray-400 dark:bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-500 active:bg-gray-600 focus:outline-none focus:border-gray-500 focus:shadow-outline-gray transition ease-in-out duration-150"},{default:n(()=>[o("span",null,i(r(e)("Homepage")),1)]),_:1},8,["href"])])]),o("div",E,[o("div",I,[a.value&&l.value.title?(m(),h(x,{key:0,"text-color":"text-red-800 dark:text-red-500","border-color":"border-red-500"},{body:n(()=>[p(i(l.value.body),1)]),default:n(()=>[p(i(l.value.title)+" ",1)]),_:1})):y("",!0),a.value&&t.userLastActiveSubmission?(m(),h(x,{key:1,"text-color":"text-sky-800 dark:text-sky-500","border-color":"border-sky-500"},{body:n(()=>[o("p",null,i(r(e)("You have an active request for this application. Applied on :date.",{date:r(_)(t.userLastActiveSubmission.created_at)})),1),o("div",J,[d(c,{class:"p-2 border border-sky-800 dark:border-sky-500 rounded text-sky-800 dark:text-sky-500 hover:bg-sky-200 dark:hover:bg-sky-900",href:u.route("recruitment-submission.show",{recruitment:t.recruitment.slug,submission:t.userLastActiveSubmission.id})},{default:n(()=>[p(i(r(e)("View Request")),1)]),_:1},8,["href"])])]),default:n(()=>[p(i(r(e)("You have already applied!"))+" ",1)]),_:1})):y("",!0),t.userLastApprovedSubmission?(m(),h(x,{key:2,"text-color":"text-orange-800 dark:text-orange-500","border-color":"border-orange-500"},{body:n(()=>[o("p",null,i(r(e)("You have already applied to this application in past. Approved on :date.",{date:r(_)(t.userLastApprovedSubmission.updated_at)})),1),o("p",null,i(r(e)("You may wanna check that before applying again.")),1),o("div",U,[d(c,{class:"p-2 border border-orange-800 dark:border-orange-500 rounded text-orange-800 dark:text-orange-500 hover:bg-orange-200 dark:hover:bg-orange-900",href:u.route("recruitment-submission.show",{recruitment:t.recruitment.slug,submission:t.userLastApprovedSubmission.id})},{default:n(()=>[p(i(r(e)("View Approved Request")),1)]),_:1},8,["href"])])]),default:n(()=>[p(i(r(e)("Already approved in past! Wanna apply again?"))+" ",1)]),_:1})):y("",!0),o("div",W,[o("div",$,[t.recruitment.description?(m(),S("div",{key:0,class:"prose dark:prose-dark max-w-none mb-6 pb-6 border-b dark:border-gray-700",innerHTML:t.recruitment.description_html},null,8,z)):y("",!0),d(V,{"submit-label":r(e)("Apply"),disabled:a.value,type:"form",onSubmit:L},{default:n(()=>[d(r(R),{schema:r(A)},null,8,["schema"])]),_:1},8,["submit-label","disabled"]),!a.value&&t.recruitment.max_submission_per_user&&t.userSubmissionsCount>0?(m(),S("p",G,i(r(e)("You can apply to this application :count more time(s).",{count:t.recruitment.max_submission_per_user-t.userSubmissionsCount})),1)):y("",!0)])])]),o("div",Q,[d(F),d(T)])])])]),_:1})}}};export{le as default};
