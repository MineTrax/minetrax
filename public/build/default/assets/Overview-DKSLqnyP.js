import{o as v,d as $,a as t,h as b,e as U,p as Z,c as D,w as y,b as l,j as s,i as d,t as e,B as R,s as I,A as V,_ as q,g as Y}from"./app-Ia0bJDXi.js";import{r as A,_ as H,a as z}from"./AdminLayout-CJ_PtlCd.js";import{_ as E}from"./AppBreadcrumb-D-yy1VJY.js";import{_ as F}from"./ServerIntelServerSelector-B57V_ciX.js";import{_ as K}from"./Chart-pbeg9Upg.js";import{i as W}from"./index.es-CCcY1w6y.js";import{_ as T}from"./Card-xSJBqBdx.js";import{_ as O}from"./CardContent-CE_SpfjF.js";import{s as x,b as G,u as B}from"./BaseLayout-CyMXUReW.js";import{e as g,s as S,a as C,b as P,c as J}from"./subMonths-B0qqqeZO.js";import{a as Q,r as X}from"./UserGroupIcon-Bne1tRo-.js";import{I as f}from"./Icon-BR_JXAZL.js";import{m as w}from"./millify-C1Upo5ih.js";import{L as tt}from"./LoadingSpinner-r7xua1a_.js";import{r as M,a as j}from"./FireIcon-DmvCSW2C.js";import{_ as st}from"./AlertCard-DZGSGYW7.js";import"./useAuthorizable-Buizf3Yh.js";import"./CloudArrowDownIcon-vObJWmJX.js";import"./index-5qxomotu.js";import"./utils-D-KgF5mV.js";import"./XSelect-CAfXjSv2.js";import"./Label-DZbOjpU-.js";import"./SelectValue-CsA2ftb2.js";import"./useForwardPropsEmits-WVrHBpLe.js";import"./Teleport-DSkR7jkG.js";import"./chevron-down-CtjWoryU.js";import"./VisuallyHidden-Cc6JWPqo.js";import"./useFormControl-D3_NwxXr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./x-BUMdF8YT.js";import"./XMarkIcon-aRZJoNuL.js";function et(i,n){return v(),$("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"})])}function at(i,n){return v(),$("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"})])}const lt={class:"flex justify-between items-center"},ot={class:"font-extrabold text-foreground flex items-center"},rt={__name:"ServerOnlineActivityOverTimeMetricBox",props:{servers:{type:Array,required:!1}},setup(i){const{__:n}=I();let o=b({}),a=b(null),m=b(!0),u=b(null);const c=i,h=U(()=>u.value===null||u.value.length<=0||u.value[0]===null||u.value[1]===null);async function k(){m.value=!0;let r={};h.value||(r.from_date=u.value[0],r.to_date=u.value[1]),c.servers&&c.servers.length>0&&(r.servers=c.servers);const _=await V.get(route("admin.graph.server-online-activity",r));m.value=!1,a.value=_.data,o.value={tooltip:{trigger:"axis",position:function(p){return[p[0],"10%"]}},legend:{},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{type:"time"},yAxis:{type:"value",boundaryGap:[0,"10%"]},dataZoom:[{type:"inside",start:90,end:100,zoomLock:!0},{start:90,end:100}],series:a.value.labels.map((p,N)=>({name:p,type:"line",smooth:!0,symbol:"none",seriesLayoutBy:"column",encode:{y:N+1},emphasis:{focus:"series"}})),dataset:{source:a.value.data}}}Z(async()=>{await k()});const L=[{text:n("Today"),onClick(){const r=new Date;return[x(r),g(r)]}},{text:n("Yesterday"),onClick(){const r=S(new Date,1);return[x(r),g(r)]}},{text:n("Last 7 Days"),onClick(){const r=new Date,_=S(r,7);return[x(_),g(r)]}},{text:n("Last 30 Days"),onClick(){const r=new Date,_=S(r,30);return[x(_),g(r)]}},{text:n("This Month"),onClick(){const r=new Date,_=C(r);return[x(_),g(r)]}},{text:n("Last Month"),onClick(){const r=new Date,_=C(P(r,1)),p=J(P(r,1));return[x(_),g(p)]}},{text:n("This Year"),onClick(){const r=new Date,_=G(r);return[x(_),g(r)]}}];return(r,_)=>(v(),D(s(T),{class:"w-full h-full"},{default:y(()=>[l(s(O),{class:"p-4 space-y-6"},{default:y(()=>[t("div",lt,[t("h3",ot,[l(s(Q),{class:"w-6 mr-2"}),d(" "+e(s(n)("Server Online Activity")),1)]),l(s(W),{value:s(u),"onUpdate:value":_[0]||(_[0]=p=>R(u)?u.value=p:u=p),type:"date",range:"",placeholder:s(n)("View for date range"),"input-class":"block w-full p-2 text-sm border border-input rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:border-primary focus:ring-1 focus:ring-ring",shortcuts:L,onChange:_[1]||(_[1]=p=>k())},null,8,["value","placeholder"])]),l(K,{options:s(o),height:"350px",loading:s(m),autoresize:!0},null,8,["options","loading"])]),_:1})]),_:1}))}},nt={class:"font-extrabold text-foreground flex mt-2 items-center"},it={key:0,class:"h-80 flex justify-center items-center"},ct={key:1,class:"m-0 p-0"},dt={class:"table-auto min-w-full text-sm dark:text-foreground text-foreground"},_t={class:"border-b border-border"},ut={scope:"col",class:"text-left p-2"},pt={scope:"col",class:"text-left p-2"},mt={scope:"col",class:"text-left p-2"},ht={scope:"col",class:"text-left p-2"},ft={class:"p-2 flex"},yt={class:"p-2"},vt={class:"p-2"},xt={class:"p-2"},gt={class:"p-2"},wt={class:"p-2 flex"},bt={class:"p-2"},kt={class:"p-2"},$t={class:"p-2"},Dt={class:"p-2"},St={class:"p-2 flex"},Mt={class:"p-2"},Tt={class:"p-2"},Ot={class:"p-2"},Lt={class:"p-2"},At={class:"p-2 flex"},Ct={class:"p-2"},Pt={class:"p-2"},jt={class:"p-2"},Zt={class:"p-2"},It={class:"p-2 flex"},Bt={class:"p-2"},Nt={class:"p-2"},Ut={class:"p-2"},Rt={class:"p-2"},Vt={class:"p-2 flex"},qt={class:"p-2"},Yt={class:"p-2"},Ht={class:"p-2"},zt={class:"p-2"},Et={class:"p-2 flex"},Ft={class:"p-2"},Kt={class:"p-2"},Wt={class:"p-2"},Gt={class:"p-2"},Jt={class:"p-2 flex"},Qt={class:"p-2"},Xt={class:"p-2"},ts={class:"p-2"},ss={class:"p-2"},es={class:"p-2 flex"},as={class:"p-2"},ls={class:"p-2"},os={class:"p-2"},rs={class:"p-2"},ns={__name:"ServerIntelOverviewNumbersBox",props:{servers:{type:Array,required:!1}},setup(i){const{secondsToHMS:n}=B(),o=i;let a=b(null),m=b(!0);async function u(){m.value=!0;let c={};o.servers&&o.servers.length>0&&(c.servers=o.servers);const h=await axios.get(route("admin.intel.server.index.numbers",c));m.value=!1,a.value=h.data.numbers}return Z(async()=>{await u()}),(c,h)=>(v(),D(s(T),{class:"w-full h-full"},{default:y(()=>[l(s(O),{class:"p-4"},{default:y(()=>[t("h3",nt,[l(s(at),{class:"w-6 mr-2"}),d(" "+e(c.__("Numbers")),1)]),s(m)?(v(),$("div",it,[l(tt,{loading:s(m)},null,8,["loading"])])):(v(),$("div",ct,[t("table",dt,[t("thead",_t,[t("tr",null,[h[0]||(h[0]=t("th",{scope:"col",class:"text-left p-2"},null,-1)),t("th",ut,e(c.__("Last 24 hours")),1),t("th",pt,e(c.__("Last 7 days")),1),t("th",mt,e(c.__("Last 30 days")),1),t("th",ht,e(c.__("All Time")),1)])]),t("tbody",null,[t("tr",null,[t("td",ft,[l(s(X),{class:"w-5 text-primary mr-1"}),d(" "+e(c.__("Total Players")),1)]),t("td",yt,e(s(a).total_players.last_24h),1),t("td",vt,e(s(a).total_players.last_7days),1),t("td",xt,e(s(a).total_players.last_30days),1),t("td",gt,e(s(a).total_players.all_time),1)]),t("tr",null,[t("td",wt,[l(s(M),{class:"w-5 text-success-500 mr-1"}),d(" "+e(c.__("Total Play Time")),1)]),t("td",bt,e(s(n)(s(a).total_playtime.last_24h,!0)),1),t("td",kt,e(s(n)(s(a).total_playtime.last_7days,!0)),1),t("td",$t,e(s(n)(s(a).total_playtime.last_30days,!0)),1),t("td",Dt,e(s(n)(s(a).total_playtime.all_time,!0)),1)]),t("tr",null,[t("td",St,[l(s(M),{class:"w-5 text-error-500 mr-1"}),d(" "+e(c.__("Total Afk Time")),1)]),t("td",Mt,e(s(n)(s(a).total_afktime.last_24h,!0)),1),t("td",Tt,e(s(n)(s(a).total_afktime.last_7days,!0)),1),t("td",Ot,e(s(n)(s(a).total_afktime.last_30days,!0)),1),t("td",Lt,e(s(n)(s(a).total_afktime.all_time,!0)),1)]),t("tr",null,[t("td",At,[l(s(A),{class:"w-5 text-success-500 mr-1"}),d(" "+e(c.__("Total Sessions")),1)]),t("td",Ct,e(s(a).total_sessions.last_24h),1),t("td",Pt,e(s(a).total_sessions.last_7days),1),t("td",jt,e(s(a).total_sessions.last_30days),1),t("td",Zt,e(s(a).total_sessions.all_time),1)]),t("tr",null,[t("td",It,[l(s(A),{class:"w-5 text-lime-500 mr-1"}),d(" "+e(c.__("Avg Session / Player")),1)]),t("td",Bt,e(s(w)(s(a).avg_session_per_player.last_24h,{precision:2})),1),t("td",Nt,e(s(w)(s(a).avg_session_per_player.last_7days,{precision:2})),1),t("td",Ut,e(s(w)(s(a).avg_session_per_player.last_30days,{precision:2})),1),t("td",Rt,e(s(w)(s(a).avg_session_per_player.all_time,{precision:2})),1)]),t("tr",null,[t("td",Vt,[l(s(M),{class:"w-5 text-amber-500 mr-1"}),d(" "+e(c.__("Avg Session Playtime")),1)]),t("td",qt,e(s(n)(s(a).avg_session_playtime.last_24h,!0)),1),t("td",Yt,e(s(n)(s(a).avg_session_playtime.last_7days,!0)),1),t("td",Ht,e(s(n)(s(a).avg_session_playtime.last_30days,!0)),1),t("td",zt,e(s(n)(s(a).avg_session_playtime.all_time,!0)),1)]),t("tr",null,[t("td",Et,[l(s(j),{class:"w-5 text-pink-500 mr-1"}),d(" "+e(c.__("Total Player Kills")),1)]),t("td",Ft,e(s(a).total_player_kills.last_24h),1),t("td",Kt,e(s(a).total_player_kills.last_7days),1),t("td",Wt,e(s(a).total_player_kills.last_30days),1),t("td",Gt,e(s(a).total_player_kills.all_time),1)]),t("tr",null,[t("td",Jt,[l(s(j),{class:"w-5 text-success-500 mr-1"}),d(" "+e(c.__("Total Mob Kills")),1)]),t("td",Qt,e(s(a).total_mob_kills.last_24h),1),t("td",Xt,e(s(a).total_mob_kills.last_7days),1),t("td",ts,e(s(a).total_mob_kills.last_30days),1),t("td",ss,e(s(a).total_mob_kills.all_time),1)]),t("tr",null,[t("td",es,[l(f,{name:"skull-outline",class:"w-5 text-error-500 mr-1"}),d(" "+e(c.__("Total Deaths")),1)]),t("td",as,e(s(a).total_deaths.last_24h),1),t("td",ls,e(s(a).total_deaths.last_7days),1),t("td",os,e(s(a).total_deaths.last_30days),1),t("td",rs,e(s(a).total_deaths.all_time),1)])])])]))]),_:1})]),_:1}))}},is={class:"px-10 py-8 mx-auto space-y-4"},cs={class:"flex justify-between items-center"},ds={id:"row1"},_s={id:"row2",class:"flex justify-between flex-1 space-x-4"},us={class:"font-extrabold text-foreground flex items-center"},ps={class:"flex flex-col text-sm mt-5"},ms={class:"table-auto min-w-full text-foreground"},hs={class:"py-2 flex"},fs={class:"p-2 text-right"},ys={class:"py-2 flex"},vs={class:"p-2 text-right"},xs={class:"py-2 flex"},gs={class:"p-2 text-right"},ws={class:"py-2 flex"},bs={class:"p-2 text-right"},ks={class:"py-2 flex"},$s={class:"p-2 text-right"},Ds={class:"py-2 flex"},Ss={class:"p-2 text-right"},Ms={class:"py-2 flex"},Ts={class:"p-2 text-right"},Os={class:"py-2 flex"},Ls={class:"p-2 text-right"},As={class:"py-2 flex"},Cs={class:"p-2 pb-4 text-right"},de={__name:"Overview",props:{serverList:{type:Object},filters:{type:Object},last7DaysStats:{type:Object},noIntelForOverWeek:{type:Boolean}},setup(i){var c,h,k;const{secondsToHMS:n}=B(),{__:o}=I(),a=i;let m=(h=(c=a.filters)==null?void 0:c.servers)!=null&&h.length?(k=a.filters)==null?void 0:k.servers[0]:null;const u=[{text:o("Admin"),current:!1},{text:o("Server Intel"),current:!1},{text:o("Overview"),current:!0},{text:a.serverList[m]??o("All Servers"),current:!0}];return(L,r)=>(v(),D(H,null,{default:y(()=>{var _,p;return[l(q,{title:s(o)("Overview - ServerIntel")},null,8,["title"]),t("div",is,[t("div",cs,[l(E,{class:"mt-0","breadcrumb-class":"max-w-none px-0 md:px-0",items:u}),l(F,{"server-list":i.serverList,filters:i.filters},null,8,["server-list","filters"])]),i.noIntelForOverWeek?(v(),D(st,{key:0,variant:"warning"},{default:y(()=>[d(e(s(o)("Server haven't sent Intel data for over 7 days.")),1)]),_:1})):Y("",!0),t("div",ds,[l(rt,{servers:(_=i.filters)==null?void 0:_.servers},null,8,["servers"])]),t("div",_s,[l(ns,{servers:(p=i.filters)==null?void 0:p.servers},null,8,["servers"]),l(s(T),{class:"w-full basis-2/6"},{default:y(()=>[l(s(O),{class:"p-4"},{default:y(()=>[t("h3",us,[l(s(z),{class:"w-6 mr-2"}),d(" "+e(s(o)("Last 7 Days")),1)]),t("div",ps,[t("table",ms,[t("tbody",null,[t("tr",null,[t("td",hs,[l(f,{name:"users",class:"w-5 text-primary mr-2"}),d(" "+e(s(o)("Unique Players")),1)]),t("td",fs,e(i.last7DaysStats.uniquePlayersCount),1)]),t("tr",null,[t("td",ys,[l(f,{name:"users",class:"w-5 text-lime-500 mr-2"}),d(" "+e(s(o)("New Players")),1)]),t("td",vs,e(i.last7DaysStats.newPlayersCount),1)]),t("tr",null,[t("td",xs,[l(f,{name:"users",class:"w-5 text-muted-foreground mr-2"}),d(" "+e(s(o)("Old Players")),1)]),t("td",gs,e(i.last7DaysStats.oldPlayersCount),1)]),t("tr",null,[t("td",ws,[l(f,{name:"users",class:"w-5 text-success-500 mr-2"}),d(" "+e(s(o)("Peak Online Players")),1)]),t("td",bs,e(i.last7DaysStats.peekOnlinePlayersCount??s(o)("none")),1)]),t("tr",null,[t("td",ks,[l(f,{name:"joystick",class:"w-5 text-lime-500 mr-2"}),d(" "+e(s(o)("Avg TPS")),1)]),t("td",$s,e(i.last7DaysStats.averageTps?s(w)(i.last7DaysStats.averageTps,{precision:2}):s(o)("none")),1)]),t("tr",null,[t("td",Ds,[l(f,{name:"joystick",class:"w-5 text-destructive mr-2"}),d(" "+e(s(o)("Lowest TPS")),1)]),t("td",Ss,e(i.last7DaysStats.lowestTps?s(w)(i.last7DaysStats.lowestTps,{precision:2}):s(o)("none")),1)]),t("tr",null,[t("td",Ms,[l(f,{name:"cpu",class:"w-5 text-primary mr-2"}),d(" "+e(s(o)("Avg CPU Load")),1)]),t("td",Ts,e(i.last7DaysStats.averageCpuLoad?s(w)(i.last7DaysStats.averageCpuLoad,{precision:2}):s(o)("none")),1)]),t("tr",null,[t("td",Os,[l(s(et),{class:"w-5 text-success-500 mr-2"}),d(" "+e(s(o)("Longest Uptime")),1)]),t("td",Ls,e(i.last7DaysStats.longestUptime?s(n)(i.last7DaysStats.longestUptime):s(o)("none")),1)]),t("tr",null,[t("td",As,[l(f,{name:"toggle-off",class:"w-5 text-destructive mr-2"}),d(" "+e(s(o)("Restarts")),1)]),t("td",Cs,e(i.last7DaysStats.noOfRestarts??s(o)("none")),1)])])])])]),_:1})]),_:1})])])]}),_:1}))}};export{de as default};
