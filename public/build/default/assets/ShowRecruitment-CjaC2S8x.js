import{_ as F}from"./AppLayout-fnl43EL1.js";import{S as R}from"./ServerStatusBox-D2-QhdP6.js";import{S as N}from"./ShoutBox-je8W56BK.js";import{R as k,E as T,h as w,a2 as E,y as _,c as y,w as r,s as P,o as m,b as u,a as i,i as d,t as n,g as f,j as o,d as A,D as q,n as D,k as M}from"./app-Bh5uq5T2.js";import{u as O}from"./useFormKit-DsPcY36i.js";import{_ as x}from"./AlertCard-Br8hCh2A.js";import{u as j}from"./BaseLayout-DfXV1WNK.js";import{_ as K}from"./AppBreadcrumb-CEuU89zV.js";import{_ as L}from"./index-Bvduyk2Y.js";import"./Icon-B54a8he6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Card-CzH_Id9h.js";import"./utils-D-KgF5mV.js";import"./CardContent-Blze7ZpO.js";import"./CopyToClipboard-o78WAkIw.js";import"./LoadingSpinner-Be0H8hkT.js";import"./Input-L4k_NWmM.js";import"./index-BlQc97mu.js";import"./Skeleton-ByIBAWeK.js";import"./XMarkIcon-CHsIiBI1.js";import"./useForwardPropsEmits-CoSvaN6q.js";import"./chevron-down-BM8GSVcu.js";import"./Teleport-C8LT0wZ6.js";import"./VisuallyHidden-C0pHwiql.js";import"./x-Dxr5v1SF.js";import"./useAuthorizable-B2TCKEv8.js";const $={class:"py-4 px-2 md:px-10 max-w-screen-2xl mx-auto"},I={class:"flex flex-col md:flex-row md:space-x-4"},z={class:"md:w-9/12 flex-1"},U={class:"flex mt-2"},W={class:"flex mt-2"},G={class:"min-w-full"},J={class:"bg-card text-card-foreground border rounded-lg shadow p-4 md:p-6"},Q={class:"font-bold text-4xl text-foreground mb-5"},X=["innerHTML"],Z={key:1,class:"text-xs text-muted-foreground text-right"},Ce={__name:"ShowRecruitment",props:{recruitment:{type:Object},currentUserCanSubmit:{type:Boolean},userVerified:{type:Boolean},userHasLinkedPlayer:{type:Boolean},userSubmissionsCount:{type:Number},secondsSinceLastSubmission:{type:Number},userLastActiveSubmission:{type:Object},userLastApprovedSubmission:{type:Object}},setup(s){const{__:e}=P(),{secondsToHMS:C,formatToDayDateString:S}=j(),t=s,B=O().generateSchemaFromFieldsArray(t.recruitment.fields),g=k().props.generalSettings.enable_sticky_header_menu,H=[{text:e("Home"),url:route("home"),current:!1},{text:e("Applications"),url:route("recruitment.index"),current:!1},{text:T.truncate(t.recruitment.title,{length:50}),current:!0}],V=async c=>{await Y(c)},Y=c=>new Promise((p,h)=>{M({...c}).post(route("recruitment.submit",t.recruitment.slug),{onSuccess:b=>{p(b)},onError:b=>{h(b)}})}),l=w({title:null,body:null}),a=w(!1);return E(()=>{var c,p;t.recruitment.status.value!="active"&&(l.value={title:e("Application Closed!"),body:e("This application form is currently closed. Please check back later.")},a.value=!0),(p=(c=k().props)==null?void 0:c.auth)!=null&&p.user||(l.value={title:e("Login or Register to Apply!"),body:e("You need to be logged in to apply to this application.")},a.value=!0),t.userLastActiveSubmission?a.value=!0:t.recruitment.max_submission_per_user&&t.userSubmissionsCount>=t.recruitment.max_submission_per_user?(l.value={title:e("Max Submissions Reached!"),body:e("You have reached the maximum number of submissions for this application.")},a.value=!0):t.recruitment.submission_cooldown_in_seconds&&t.secondsSinceLastSubmission&&t.secondsSinceLastSubmission<t.recruitment.submission_cooldown_in_seconds?(l.value={title:e("You are on a Cooldown!"),body:e("You need to wait :seconds before submitting this application again.",{seconds:C(t.recruitment.submission_cooldown_in_seconds-t.secondsSinceLastSubmission,!0)})},a.value=!0):t.recruitment.is_allow_only_verified_users&&!t.userVerified?(l.value={title:e("Account Verification Required!"),body:e("Only verified users can apply to this application. Please verify your account.")},a.value=!0):t.recruitment.is_allow_only_player_linked_users&&!t.userHasLinkedPlayer&&(l.value={title:e("Account Linking Required!"),body:e("Only users with linked players can apply to this application. Please link a player to your account.")},a.value=!0)}),(c,p)=>{const h=_("AppHead"),v=_("InertiaLink"),b=_("FormKit");return m(),y(F,null,{default:r(()=>[u(h,{title:s.recruitment.title},null,8,["title"]),u(K,{items:H}),i("div",$,[i("div",I,[i("div",z,[a.value&&l.value.title?(m(),y(x,{key:0,"text-color":"text-error-800 dark:text-error-500","border-color":"border-error-500"},{body:r(()=>[d(n(l.value.body),1)]),default:r(()=>[d(n(l.value.title)+" ",1)]),_:1})):f("",!0),a.value&&s.userLastActiveSubmission?(m(),y(x,{key:1,"text-color":"text-primary dark:text-primary","border-color":"border-primary"},{body:r(()=>[i("p",null,n(o(e)("You have an active request for this application. Applied on :date.",{date:o(S)(s.userLastActiveSubmission.created_at)})),1),i("div",U,[u(o(L),{"as-child":"",variant:"outline"},{default:r(()=>[u(v,{href:c.route("recruitment-submission.show",{recruitment:s.recruitment.slug,submission:s.userLastActiveSubmission.id})},{default:r(()=>[d(n(o(e)("View Request")),1)]),_:1},8,["href"])]),_:1})])]),default:r(()=>[d(n(o(e)("You have already applied!"))+" ",1)]),_:1})):f("",!0),s.userLastApprovedSubmission?(m(),y(x,{key:2,"text-color":"text-orange-800 dark:text-orange-500","border-color":"border-orange-500"},{body:r(()=>[i("p",null,n(o(e)("You have already applied to this application in past. Approved on :date.",{date:o(S)(s.userLastApprovedSubmission.updated_at)})),1),i("p",null,n(o(e)("You may wanna check that before applying again.")),1),i("div",W,[u(o(L),{"as-child":"",variant:"outline"},{default:r(()=>[u(v,{href:c.route("recruitment-submission.show",{recruitment:s.recruitment.slug,submission:s.userLastApprovedSubmission.id})},{default:r(()=>[d(n(o(e)("View Approved Request")),1)]),_:1},8,["href"])]),_:1})])]),default:r(()=>[d(n(o(e)("Already approved in past! Wanna apply again?"))+" ",1)]),_:1})):f("",!0),i("div",G,[i("div",J,[i("h1",Q,n(s.recruitment.title),1),s.recruitment.description?(m(),A("div",{key:0,class:"prose dark:prose-invert max-w-none mb-6 pb-6 border-b border-border",innerHTML:s.recruitment.description_html},null,8,X)):f("",!0),u(b,{"submit-label":o(e)("Apply"),disabled:a.value,type:"form",onSubmit:V},{default:r(()=>[u(o(q),{schema:o(B)},null,8,["schema"])]),_:1},8,["submit-label","disabled"]),!a.value&&s.recruitment.max_submission_per_user&&s.userSubmissionsCount>0?(m(),A("p",Z,n(o(e)("You can apply to this application :count more time(s).",{count:s.recruitment.max_submission_per_user-s.userSubmissionsCount})),1)):f("",!0)])])]),i("div",{class:D(["hidden md:flex flex-col md:w-3/12 flex-none space-y-4 sticky",{"top-16":o(g),"top-5":!o(g)}])},[u(R),u(N)],2)])])]),_:1})}}};export{Ce as default};
