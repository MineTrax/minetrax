import{u as V,A as Y}from"./AppLayout-D09sHPWy.js";import{S as F}from"./ServerStatusBox-6MQUIOTd.js";import{S as T}from"./ShoutBox-Bgd5_jY3.js";import{r as k,A as H,s as f,c as h,w as n,o as m,b as c,a as s,t as i,u as o,f as p,e as y,d as S,L as R,q,k as N,T as P}from"./app-B6MSbjiR.js";import{u as M}from"./useFormKit-DsPcY36i.js";import{_ as x}from"./AlertCard-Byhaxell.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-DyYhHgsS.js";import"./useAuthorizable-Cf1MTXSt.js";import"./CopyToClipboard-o78WAkIw.js";import"./XMarkIcon-o8SeIREM.js";const O={class:"py-4 px-2 md:py-12 md:px-10 max-w-7xl mx-auto"},j={class:"flex justify-between md:mb-4"},D={class:"text-center font-bold text-2xl text-secondary-900 dark:text-secondary-200 mb-5"},E={class:""},K={class:"flex flex-col md:flex-row md:space-x-4"},I={class:"overflow-x-auto md:w-9/12"},U={class:"flex mt-2"},W={class:"flex mt-2"},$={class:"min-w-full"},z={class:"shadow max-w-none bg-white dark:bg-surface-800 px-3 py-2 md:px-10 md:py-5 overflow-hidden rounded"},G=["innerHTML"],J={key:1,class:"text-xs text-secondary-500 dark:text-secondary-400 text-right"},Q={class:"md:w-3/12 flex-1 space-y-4 mt-4 md:mt-0"},le={__name:"ShowRecruitment",props:{recruitment:{type:Object},currentUserCanSubmit:{type:Boolean},userVerified:{type:Boolean},userHasLinkedPlayer:{type:Boolean},userSubmissionsCount:{type:Number},secondsSinceLastSubmission:{type:Number},userLastActiveSubmission:{type:Object},userLastApprovedSubmission:{type:Object}},setup(t){const{__:e}=q(),{secondsToHMS:w,formatToDayDateString:_}=V(),r=t,L=M().generateSchemaFromFieldsArray(r.recruitment.fields),A=async u=>{await C(u)},C=u=>new Promise((b,v)=>{N({...u}).post(route("recruitment.submit",r.recruitment.slug),{onSuccess:d=>{b(d)},onError:d=>{v(d)}})}),l=k({title:null,body:null}),a=k(!1);return H(()=>{var u,b;r.recruitment.status.value!="active"&&(l.value={title:e("Application Closed!"),body:e("This application form is currently closed. Please check back later.")},a.value=!0),(b=(u=P().props)==null?void 0:u.auth)!=null&&b.user||(l.value={title:e("Login or Register to Apply!"),body:e("You need to be logged in to apply to this application.")},a.value=!0),r.userLastActiveSubmission?a.value=!0:r.recruitment.max_submission_per_user&&r.userSubmissionsCount>=r.recruitment.max_submission_per_user?(l.value={title:e("Max Submissions Reached!"),body:e("You have reached the maximum number of submissions for this application.")},a.value=!0):r.recruitment.submission_cooldown_in_seconds&&r.secondsSinceLastSubmission&&r.secondsSinceLastSubmission<r.recruitment.submission_cooldown_in_seconds?(l.value={title:e("You are on a Cooldown!"),body:e("You need to wait :seconds before submitting this application again.",{seconds:w(r.recruitment.submission_cooldown_in_seconds-r.secondsSinceLastSubmission,!0)})},a.value=!0):r.recruitment.is_allow_only_verified_users&&!r.userVerified?(l.value={title:e("Account Verification Required!"),body:e("Only verified users can apply to this application. Please verify your account.")},a.value=!0):r.recruitment.is_allow_only_player_linked_users&&!r.userHasLinkedPlayer&&(l.value={title:e("Account Linking Required!"),body:e("Only users with linked players can apply to this application. Please link a player to your account.")},a.value=!0)}),(u,b)=>{const v=f("app-head"),g=f("inertia-link"),d=f("InertiaLink"),B=f("FormKit");return m(),h(Y,null,{default:n(()=>[c(v,{title:t.recruitment.title},null,8,["title"]),s("div",O,[s("div",j,[s("h1",D,i(t.recruitment.title),1),s("div",E,[c(g,{href:u.route("home"),class:"inline-flex items-center px-4 py-2 bg-surface-400 dark:bg-surface-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-surface-500 active:bg-surface-600 focus:outline-none focus:border-secondary-500 focus:shadow-outline-gray transition ease-in-out duration-150"},{default:n(()=>[s("span",null,i(o(e)("Homepage")),1)]),_:1},8,["href"])])]),s("div",K,[s("div",I,[a.value&&l.value.title?(m(),h(x,{key:0,"text-color":"text-error-800 dark:text-error-500","border-color":"border-error-500"},{body:n(()=>[p(i(l.value.body),1)]),default:n(()=>[p(i(l.value.title)+" ",1)]),_:1})):y("",!0),a.value&&t.userLastActiveSubmission?(m(),h(x,{key:1,"text-color":"text-primary-800 dark:text-primary-500","border-color":"border-primary-500"},{body:n(()=>[s("p",null,i(o(e)("You have an active request for this application. Applied on :date.",{date:o(_)(t.userLastActiveSubmission.created_at)})),1),s("div",U,[c(d,{class:"p-2 border border-primary-800 dark:border-primary-500 rounded text-primary-800 dark:text-primary-500 hover:bg-primary-200 dark:hover:bg-primary-900",href:u.route("recruitment-submission.show",{recruitment:t.recruitment.slug,submission:t.userLastActiveSubmission.id})},{default:n(()=>[p(i(o(e)("View Request")),1)]),_:1},8,["href"])])]),default:n(()=>[p(i(o(e)("You have already applied!"))+" ",1)]),_:1})):y("",!0),t.userLastApprovedSubmission?(m(),h(x,{key:2,"text-color":"text-orange-800 dark:text-orange-500","border-color":"border-orange-500"},{body:n(()=>[s("p",null,i(o(e)("You have already applied to this application in past. Approved on :date.",{date:o(_)(t.userLastApprovedSubmission.updated_at)})),1),s("p",null,i(o(e)("You may wanna check that before applying again.")),1),s("div",W,[c(d,{class:"p-2 border border-orange-800 dark:border-orange-500 rounded text-orange-800 dark:text-orange-500 hover:bg-orange-200 dark:hover:bg-orange-900",href:u.route("recruitment-submission.show",{recruitment:t.recruitment.slug,submission:t.userLastApprovedSubmission.id})},{default:n(()=>[p(i(o(e)("View Approved Request")),1)]),_:1},8,["href"])])]),default:n(()=>[p(i(o(e)("Already approved in past! Wanna apply again?"))+" ",1)]),_:1})):y("",!0),s("div",$,[s("div",z,[t.recruitment.description?(m(),S("div",{key:0,class:"prose dark:prose-invert max-w-none mb-6 pb-6 border-b dark:border-secondary-700",innerHTML:t.recruitment.description_html},null,8,G)):y("",!0),c(B,{"submit-label":o(e)("Apply"),disabled:a.value,type:"form",onSubmit:A},{default:n(()=>[c(o(R),{schema:o(L)},null,8,["schema"])]),_:1},8,["submit-label","disabled"]),!a.value&&t.recruitment.max_submission_per_user&&t.userSubmissionsCount>0?(m(),S("p",J,i(o(e)("You can apply to this application :count more time(s).",{count:t.recruitment.max_submission_per_user-t.userSubmissionsCount})),1)):y("",!0)])])]),s("div",Q,[c(F),c(T)])])])]),_:1})}}};export{le as default};
