import{_ as L}from"./AdminLayout-C3c7ijIe.js";import{u as N}from"./useAuthorizable-e--Skqmp.js";import{u as P}from"./BaseLayout-sXkR-4Uw.js";import{r as A,s as w,z as $,c as v,w as r,q as V,o,b as i,u as e,a as s,t,p as d,f as u,e as g,d as c,P as q,K as T}from"./app-jpCRGzWE.js";import{_ as B}from"./DataTable-pHQxfe0U.js";import{D as m}from"./DtRowItem-ZEfbfaLY.js";import{_ as I}from"./CommonStatusBadge-Big2RCpu.js";import{_ as O}from"./DialogModal-CQBxlOtn.js";import{_ as Q}from"./SecondaryButton-DHc-TRAg.js";import{_ as F}from"./UserDisplayname-C-ymWhX7.js";import{r as H}from"./EyeIcon-C86KfWW7.js";import{r as U}from"./ArrowPathIcon-BxRA9T6O.js";import{r as z}from"./TrashIcon-C-n0oh30.js";import"./keyboard-BsWWh6cB.js";import"./open-closed-7-ABnrJt.js";import"./CloudArrowDownIcon-Dg55l3VV.js";import"./index--8hIBfIm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-wreK45eH.js";import"./vue-multiselect.esm-DnFUxAWZ.js";import"./XMarkIcon-B9z5I5uI.js";import"./hidden-DS7qYPlv.js";import"./Modal-CpEXjLYG.js";const K={class:"px-10 py-8 mx-auto text-secondary-400"},M={class:"flex justify-between mb-4"},G={class:"text-3xl font-bold text-secondary-500 dark:text-secondary-300"},J={class:"flex"},W={class:"px-4 py-4 text-sm font-medium text-secondary-800 whitespace-nowrap dark:text-secondary-200"},X=["title"],Y={key:1,class:"text-secondary-500 italic"},Z={class:"text-xs dark:text-secondary-500"},ee=["title"],te={key:1,class:"text-secondary-500 italic"},se={key:0,class:"text-secondary-600 dark:text-secondary-400"},ae={key:1,class:"text-error-500 italic"},oe={key:1,class:"italic text-secondary-500"},ne=["title"],le={key:1,class:"italic"},ce=["title"],re={class:"px-6 py-4 space-x-2 text-sm font-medium text-right whitespace-nowrap"},ie=["onClick","title"],de={class:"text-lg font-bold"},ue={class:"w-full text-sm grid-cols-2 gap-6 leading-7 md:col-span-2 md:grid"},_e={class:"col-span-2"},me={class:"font-semibold text-secondary-500"},pe={class:"col-span-2"},ye={class:"font-semibold text-secondary-500"},fe={key:0},he={key:1,class:"italic text-secondary-500"},xe={class:"font-semibold text-secondary-500"},ve={class:""},ke={class:"font-semibold text-secondary-500"},be={key:0},we={key:1,class:"italic text-secondary-500"},ge={class:"font-semibold text-secondary-500"},Ce={class:""},De={class:"font-semibold text-secondary-500"},Ae={class:"font-semibold text-secondary-500"},$e={class:"flex items-center"},qe=["title"],Te={key:1,class:"text-secondary-500 italic"},Ie={class:"text-sm"},je={class:"font-semibold text-secondary-500"},Ee={class:"flex items-center"},Re=["title"],Se={key:1,class:"text-secondary-500 italic"},Le={class:"font-semibold text-secondary-500"},Ne={key:0,class:"flex items-center"},Pe={class:"flex-shrink-0 w-8 h-8"},Ve=["src"],Be={class:"ml-2"},Oe={key:0,class:"font-extrabold text-secondary-700 dark:text-secondary-300"},Qe={key:1,class:"italic text-error-500"},Fe={key:1,class:"italic text-secondary-500"},He={class:"font-semibold text-secondary-500"},Ue={key:0,class:"flex items-center"},ze={key:1,class:"italic text-secondary-500"},Ke={class:"font-semibold text-secondary-500"},Me={class:""},Ge={class:"font-semibold text-secondary-500"},Je={class:"flex items-center"},We=["title"],Xe={class:"col-span-2"},Ye={class:"font-semibold text-secondary-500"},Ze={key:0},et={key:1,class:"italic text-secondary-500"},Dt={__name:"IndexCommandQueue",props:{commandQueues:Object,filters:Object},setup(C){const{can:k}=N(),{__:a}=V(),{formatTimeAgoToNow:f,formatToDayDateString:h}=P(),j=[{key:"id",label:a("ID"),sortable:!0},{key:"parsed_command",label:a("Command"),sortable:!0,filterable:{type:"text"}},{key:"server_id",sortable:!0,label:a("Server"),filterable:{key:"server.name",type:"text"}},{key:"status",label:a("Status"),sortable:!0,filterable:{type:"multiselect",options:["pending","running","failed","cancelled","deferred","completed"]}},{key:"last_attempt_at",sortable:!0,label:a("Last Attempted"),class:"whitespace-nowrap"},{key:"execute_at",sortable:!0,label:a("Execute At"),class:"whitespace-nowrap"},{key:"tag",sortable:!0,label:a("Tags"),filterable:{type:"text"}},{key:"player_id",sortable:!0,label:a("For Player"),class:"whitespace-nowrap",filterable:{key:"player.username",type:"text"}},{key:"output",label:a("Output"),sortable:!0,filterable:{type:"text"}},{key:"created_at",sortable:!0,label:a("Created"),class:"whitespace-nowrap"},{key:"actions",label:a("Actions"),sortable:!1,class:"w-1/12 text-right"}];let p=A(!1),l=A({});const E=y=>{l.value=y,p.value=!0};return(y,x)=>{const R=w("app-head"),b=w("InertiaLink"),S=w("inertia-link"),D=$("confirm"),_=$("tippy");return o(),v(L,null,{default:r(()=>[i(R,{title:e(a)("Command History")},null,8,["title"]),s("div",K,[s("div",M,[s("h1",G,t(e(a)("Command History")),1),s("div",J,[e(k)("create command_queues")?d((o(),v(b,{key:0,href:y.route("admin.command-queue.retry"),method:"post",as:"button",class:"mr-2 inline-flex items-center px-4 py-2 text-xs font-semibold tracking-widest text-white uppercase transition duration-150 ease-in-out bg-success-500 border border-transparent rounded-md hover:bg-success-700 active:bg-success-900 focus:outline-none focus:border-success-900 focus:shadow-outline-gray"},{default:r(()=>[u(t(e(a)("Retry All Failed")),1)]),_:1},8,["href"])),[[D,{message:"Are you sure you wanna retry all failed & cancelled command queues? Please note that failed commands automatically get retried till they reach the max attempts."}]]):g("",!0)])]),i(B,{class:"bg-white rounded shadow dark:bg-surface-800",header:j,data:C.commandQueues,filters:C.filters},{default:r(({item:n})=>[s("td",W,t(n.id),1),i(m,{class:"text-left font-mono"},{default:r(()=>[u(t(n.parsed_command),1)]),_:2},1024),i(m,{class:"text-left whitespace-nowrap"},{default:r(()=>[u(t(n.server.name),1)]),_:2},1024),i(m,{class:"text-left"},{default:r(()=>[i(I,{status:n.status.value},null,8,["status"])]),_:2},1024),i(m,null,{default:r(()=>[n.last_attempt_at?d((o(),c("div",{key:0,class:"whitespace-nowrap",title:e(h)(n.last_attempt_at)},[u(t(e(f)(n.last_attempt_at)),1)],8,X)),[[_]]):(o(),c("div",Y,t("not yet"))),s("div",Z,t(e(a)("Attempts: :attempts/:max_attempts",{attempts:n.attempts,max_attempts:n.max_attempts??1})),1)]),_:2},1024),i(m,null,{default:r(()=>[n.execute_at?d((o(),c("div",{key:0,class:"text-sm font-medium text-secondary-900 dark:text-secondary-300 whitespace-nowrap",title:e(h)(n.execute_at)},[u(t(e(f)(n.execute_at)),1)],8,ee)),[[_]]):(o(),c("div",te,t("no delay")))]),_:2},1024),i(m,{class:"text-left"},{default:r(()=>[u(t(n.tag??e(a)("none")),1)]),_:2},1024),i(m,{class:"text-center"},{default:r(()=>[n.player_id?d((o(),v(S,{key:0,as:"a",href:y.route("player.show",n.player.uuid),class:"text-sm font-medium text-secondary-900 dark:text-secondary-400 focus:outline-none cursor-pointer hover:underline",content:n.player.uuid},{default:r(()=>[n.player.username?(o(),c("span",se,t(n.player.username),1)):(o(),c("span",ae,t(e(a)("Unknown")),1))]),_:2},1032,["href","content"])),[[_]]):(o(),c("div",oe,t(e(a)("none")),1))]),_:2},1024),i(m,{class:"text-left"},{default:r(()=>[n.output?(o(),c("span",{key:0,class:"truncate",title:n.output},t(n.output.length>10?n.output.substring(0,10)+"...":n.output),9,ne)):(o(),c("span",le,t(e(a)("none")),1))]),_:2},1024),i(m,null,{default:r(()=>[d((o(),c("div",{class:"text-sm font-medium text-secondary-900 dark:text-secondary-300 whitespace-nowrap",title:e(h)(n.created_at)},[u(t(e(f)(n.created_at)),1)],8,ce)),[[_]])]),_:2},1024),s("td",re,[d((o(),c("button",{onClick:tt=>E(n),class:"inline-flex items-center justify-center text-primary-500 hover:text-primary-800",title:e(a)("View Details")},[i(e(H),{class:"inline-block w-5 h-5"})],8,ie)),[[_]]),e(k)("create command_queues")&&["failed","cancelled"].includes(n.status.value)?d((o(),v(b,{key:0,as:"button",method:"post",data:{id:n.id},href:y.route("admin.command-queue.retry"),class:"inline-flex items-center justify-center text-success-600 dark:text-success-500 hover:text-success-800 dark:hover:text-success-800",title:e(a)("Retry Command")},{default:r(()=>[i(e(U),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[_]]):g("",!0),e(k)("delete command_queues")&&["pending","failed","cancelled","completed","deferred"].includes(n.status.value)?d((o(),v(b,{key:1,as:"button",method:"DELETE",data:{id:n.id},href:y.route("admin.command-queue.delete"),class:"inline-flex items-center justify-center text-error-600 hover:text-error-900 focus:outline-none",title:e(a)("Delete Command")},{default:r(()=>[i(e(z),{class:"inline-block w-5 h-5"})]),_:2},1032,["data","href","title"])),[[D,{message:"Are you sure you want to delete this command history?"}],[_]]):g("",!0)])]),_:1},8,["data","filters"])]),i(O,{show:e(p),onClose:x[1]||(x[1]=n=>T(p)?p.value=!1:p=!1)},{title:r(()=>[s("h3",de,t(e(a)("Run Details")),1)]),content:r(()=>[s("div",ue,[s("div",_e,[s("p",me,t(e(a)("Command")),1),s("code",null,t(e(l).parsed_command),1)]),s("div",pe,[s("p",ye,t(e(a)("Output")),1),e(l).output?(o(),c("code",fe,t(e(l).output),1)):(o(),c("div",he,t(e(a)("none")),1))]),s("div",null,[s("p",xe,t(e(a)("ID")),1),s("p",ve,t(e(l).id),1)]),s("div",null,[s("p",ke,t(e(a)("Command ID")),1),e(l).command_id?(o(),c("p",be,t(e(l).command_id),1)):(o(),c("p",we,t(e(a)("none")),1))]),s("div",null,[s("p",ge,t(e(a)("Server")),1),s("p",Ce,t(e(l).server.name),1)]),s("div",null,[s("p",De,t(e(a)("Status")),1),i(I,{status:e(l).status.value},null,8,["status"])]),s("div",null,[s("p",Ae,t(e(a)("Last Attempted")),1),s("div",$e,[e(l).last_attempt_at?d((o(),c("div",{key:0,class:"whitespace-nowrap",title:e(h)(e(l).last_attempt_at)},[u(t(e(f)(e(l).last_attempt_at)),1)],8,qe)),[[_]]):(o(),c("div",Te,t("not yet"))),x[2]||(x[2]=u("  ●  ")),s("div",Ie,t(e(a)("Attempts: :attempts/:max_attempts",{attempts:e(l).attempts,max_attempts:e(l).max_attempts??1})),1)])]),s("div",null,[s("p",je,t(e(a)("Execute At")),1),s("div",Ee,[e(l).execute_at?d((o(),c("div",{key:0,class:"text-sm font-medium text-secondary-900 dark:text-secondary-300 whitespace-nowrap",title:e(h)(e(l).execute_at)},[u(t(e(f)(e(l).execute_at)),1)],8,Re)),[[_]]):(o(),c("div",Se,t("no delay")))])]),s("div",null,[s("p",Le,t(e(a)("For Player")),1),s("div",null,[e(l).player_id?(o(),c("div",Ne,[s("div",Pe,[s("img",{class:"w-8 h-8",src:e(l).player.avatar_url,alt:""},null,8,Ve)]),s("div",Be,[d((o(),v(e(q),{as:"a",href:y.route("player.show",e(l).player.uuid),class:"font-medium text-secondary-900 cursor-pointer dark:text-secondary-200 focus:outline-none hover:underline",content:e(l).player.uuid},{default:r(()=>[e(l).player.username?(o(),c("span",Oe,t(e(l).player.username),1)):(o(),c("span",Qe,t(e(a)("Unknown")),1))]),_:1},8,["href","content"])),[[_]])])])):(o(),c("div",Fe,t(e(a)("none")),1))])]),s("div",null,[s("p",He,t(e(a)("User")),1),s("div",null,[e(l).user_id?(o(),c("div",Ue,[i(e(q),{href:y.route("user.public.get",e(l).user.username)},{default:r(()=>[i(F,{user:e(l).user,"icon-class":"w-4 h-4","text-class":"text-sm"},null,8,["user"])]),_:1},8,["href"])])):(o(),c("div",ze,t(e(a)("none")),1))])]),s("div",null,[s("p",Ke,t(e(a)("Tags")),1),s("p",Me,t(e(l).tag??e(a)("none")),1)]),s("div",null,[s("p",Ge,t(e(a)("Created At")),1),s("div",Je,[d((o(),c("div",{class:"text-sm font-medium text-secondary-900 dark:text-secondary-300 whitespace-nowrap",title:e(h)(e(l).created_at)},[u(t(e(f)(e(l).created_at)),1)],8,We)),[[_]])])]),s("div",Xe,[s("p",Ye,t(e(a)("Config")),1),e(l).config?(o(),c("code",Ze,t(e(l).config),1)):(o(),c("div",et,t(e(a)("none")),1))])])]),footer:r(()=>[i(Q,{onClick:x[0]||(x[0]=n=>T(p)?p.value=!1:p=!1)},{default:r(()=>[u(t(e(a)("Close")),1)]),_:1})]),_:1},8,["show"])]),_:1})}}};export{Dt as default};
