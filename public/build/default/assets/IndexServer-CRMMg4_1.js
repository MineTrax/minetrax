import{_ as V}from"./AdminLayout-CgKpHlNL.js";import{u as $}from"./useAuthorizable-CKY4A9EI.js";import{u as L}from"./AppLayout-nTzTLkcY.js";import{h as C,A as Q,s as I,z as P,c as x,w as i,q as W,o as n,b as l,u as e,a as o,f as _,t as s,e as p,p as g,d as c,l as D}from"./app-aqw-n-C2.js";import{_ as M}from"./DataTable-BHD5r2G6.js";import{D as k}from"./DtRowItem-Ca68bKhw.js";import{a as z}from"./index-LiBbe_Xz.js";import{_ as O}from"./AlertCard-pjpLYWej.js";import{r as R}from"./EyeIcon-D1zWmKZC.js";import{r as Y}from"./PencilSquareIcon-CGtGYusE.js";import{r as F}from"./TrashIcon-CKOyuanZ.js";import"./keyboard-D9MjfX7e.js";import"./open-closed-BVqjHboy.js";import"./CloudArrowDownIcon-D455bD1C.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-BHJIwx4L.js";import"./vue-multiselect.esm-Doco6gya.js";import"./XMarkIcon-Ck8A-WMF.js";import"./hidden-DyfrtWB5.js";const H={class:"px-10 py-8 mx-auto text-secondary-400"},G={class:"italic text-secondary-400 dark:text-secondary-500"},J={class:"flex justify-between mb-8"},K={class:"font-bold text-3xl text-secondary-500 dark:text-secondary-300 flex items-center"},U={class:"flex"},X={class:"hidden md:inline"},Z={class:"px-4 py-4 text-sm text-center text-secondary-800 whitespace-nowrap dark:text-secondary-200 font-bold"},ee={class:"flex items-center"},te={class:"flex-shrink-0 h-10 w-10"},re=["src"],se={class:"ml-4"},oe={class:"text-sm font-medium text-secondary-900 dark:text-secondary-300"},ae={class:"text-sm text-secondary-500 dark:text-secondary-400"},ne={class:"group"},ie={class:"text-sm filter blur-sm text-secondary-900 dark:text-secondary-300 group-hover:blur-none duration-300 cursor-text"},de={class:"text-sm text-secondary-500 dark:text-secondary-400 filter blur-sm group-hover:blur-none duration-300 cursor-text"},le={class:"px-4 space-y-1 whitespace-nowrap"},ce={class:"flex"},ue={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-surface-100 text-secondary-800 dark:bg-opacity-25 dark:text-secondary-400"},fe={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-success-100 text-success-800 dark:bg-opacity-25 dark:text-success-400"},xe={key:2,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-error-100 text-error-800 dark:bg-opacity-25 dark:text-error-400"},pe={class:"flex"},ye={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-surface-100 text-secondary-800 dark:bg-opacity-25 dark:text-secondary-400"},he={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-success-100 text-success-800 dark:bg-opacity-25 dark:text-success-400"},_e={key:2,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-error-100 text-error-800 dark:bg-opacity-25 dark:text-error-400"},be={key:3},me=["title"],ve={class:"px-6 py-4 space-x-2 text-sm font-medium text-right whitespace-nowrap"},ge={key:0},ke={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-error-100 text-error-800 dark:bg-opacity-25 dark:text-error-400"},we={key:1,class:"flex space-x-2"},Oe={__name:"IndexServer",props:{canCreateBungeeServer:Boolean,servers:Object,filters:Object},setup(b){const{can:m}=$(),{__:t}=W(),{formatTimeAgoToNow:j,formatToDayDateString:E}=L(),A=z("show-bungee-server-missing-alert",!0),N=b,q=[{key:"id",label:t("ID"),sortable:!0,class:"text-center font-bold"},{key:"name",sortable:!0,label:t("Name"),filterable:{type:"text"}},{key:"ip_address",label:t("IP:Port"),sortable:!0},{key:"type",label:t("Type"),sortable:!0},{key:"status",sortable:!1,label:t("Status")},{key:"minecraft_version",sortable:!0,label:t("Version")},{key:"created_at",sortable:!0,label:t("Added")},{key:"actions",label:t("Actions"),sortable:!1,class:"w-1/12 text-right"}],T=C({}),w=C({});Q(()=>{N.servers.data.forEach(a=>{axios.get(route("server.ping.get",a.id)).then(u=>{D(()=>{var y,d,f,S;T[a.id]={online:1,players:(d=(y=u.data)==null?void 0:y.players)==null?void 0:d.online,max:(S=(f=u.data)==null?void 0:f.players)==null?void 0:S.max}})}).catch(()=>{D(()=>T[a.id]={online:0})}),a.webquery_port?axios.get(route("server.webquery.ping",a.id)).then(u=>{D(()=>{var y,d;w[a.id]={online:1,players:(y=u.data)==null?void 0:y.online_players,max:(d=u.data)==null?void 0:d.max_players}})}).catch(()=>{D(()=>w[a.id]={online:0})}):w[a.id]={online:-1}})});function v(a){return T[a]||null}function h(a){return w[a]||null}return(a,u)=>{const y=I("app-head"),d=I("InertiaLink"),f=P("tippy"),S=P("confirm");return n(),x(V,null,{default:i(()=>[l(y,{title:e(t)("Manage Servers")},null,8,["title"]),o("div",H,[b.canCreateBungeeServer&&e(A)?(n(),x(O,{key:0,"close-button":!0,"text-color":"text-primary-800 dark:text-primary-500","border-color":"border-primary-500",onClose:u[0]||(u[0]=r=>A.value=!1)},{body:i(()=>[_(s(e(t)("Adding Proxy server is recommended if you are adding more than 1 server to MineTrax, so that it can be used to show whole network player count in homepage."))+" ",1),o("p",G,s(e(t)("Note: This is not an error. You can safely ignore this message if you don't want to add proxy server.")),1)]),default:i(()=>[_(s(e(t)("You don't have Bungee/Proxy Server Added!"))+" ",1)]),_:1})):p("",!0),o("div",J,[o("h1",K,[_(s(e(t)("Servers"))+" ",1),e(m)("create servers")?g((n(),x(d,{key:0,as:"button",title:e(t)("MineTrax automatically sync player stats every hour or as per schedule define in .env file. Click here to force a sync now."),href:a.route("admin.server.force-scan"),method:"post",class:"ml-2 inline-flex items-center px-4 py-2 border-2 border-error-600 rounded-md font-semibold text-xs text-error-600 uppercase tracking-widest focus:outline-none transition ease-in-out duration-150 dark:text-error-500 dark:border-error-700 hover:border-error-300 dark:hover:border-error-500 hover:bg-error-500 hover:text-white dark:hover:text-white"},{default:i(()=>[o("span",null,s(e(t)("Sync Player Statistics")),1)]),_:1},8,["title","href"])),[[f]]):p("",!0)]),o("div",U,[e(m)("create servers")?(n(),x(d,{key:0,href:a.route("admin.server.create"),class:"mr-1 inline-flex items-center px-4 py-2 bg-surface-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-surface-700 active:bg-surface-900 focus:outline-none focus:border-secondary-900 focus:shadow-outline-gray transition ease-in-out duration-150"},{default:i(()=>[o("span",null,s(e(t)("Add")),1),o("span",X,"Â "+s(e(t)("Server")),1)]),_:1},8,["href"])):p("",!0),e(m)("create servers")&&b.canCreateBungeeServer?(n(),x(d,{key:1,href:a.route("admin.server.create-bungee"),class:"inline-flex items-center px-4 py-2 border-2 border-secondary-800 rounded-md font-semibold text-xs text-secondary-800 uppercase tracking-widest focus:outline-none focus:border-secondary-900 transition ease-in-out duration-150 dark:text-secondary-300 dark:border-secondary-700 dark:hover:border-secondary-500"},{default:i(()=>[o("span",null,s(e(t)("Add Proxy Server")),1)]),_:1},8,["href"])):p("",!0)])]),l(M,{class:"bg-white rounded shadow dark:bg-surface-800",header:q,data:b.servers,filters:b.filters},{default:i(({item:r})=>{var B;return[o("td",Z,s(r.id),1),l(k,null,{default:i(()=>[o("div",ee,[o("div",te,[o("img",{class:"h-10 w-10",src:r.country.photo_path,alt:"Country Flag"},null,8,re)]),o("div",se,[o("div",oe,s(r.name),1),o("div",ae,s(r.hostname),1)])])]),_:2},1024),l(k,null,{default:i(()=>[o("div",ne,[o("div",ie,s(r.masked_ip_address)+" : "+s(r.join_port),1),o("div",de,s(e(t)("WebQuery: :webquery_port",{webquery_port:r.webquery_port||e(t)("not set")})),1)])]),_:2},1024),l(k,null,{default:i(()=>[_(s(r.type.key=="Bungee"?e(t)("Proxy"):r.type.key),1)]),_:2},1024),o("td",le,[o("div",ce,[v(r.id)?v(r.id).online===1?(n(),c("span",fe,s(e(t)("Server"))+" ðŸŸ¢ "+s(v(r.id).players+"/"+v(r.id).max),1)):v(r.id).online===0?(n(),c("span",xe,s(e(t)("Server"))+" ðŸ”´ ",1)):p("",!0):(n(),c("span",ue,s(e(t)("Loading"))+"...",1))]),o("div",pe,[h(r.id)?h(r.id).online===1?(n(),c("span",he,s(e(t)("WebQuery"))+" ðŸŸ¢ "+s(h(r.id).players+"/"+h(r.id).max),1)):h(r.id).online===0?(n(),c("span",_e,s(e(t)("WebQuery"))+" ðŸ”´ ",1)):h(r.id).online===-1?(n(),c("span",be)):p("",!0):(n(),c("span",ye,s(e(t)("Loading"))+"...",1))])]),l(k,null,{default:i(()=>[_(s(r.minecraft_version),1)]),_:2},1024),l(k,null,{default:i(()=>[g((n(),c("span",{title:e(E)(r.created_at)},[_(s(e(j)(r.created_at)),1)],8,me)),[[f]])]),_:2},1024),o("td",ve,[(B=r==null?void 0:r.settings)!=null&&B.is_deleting?(n(),c("div",ge,[o("span",ke,s(e(t)("Deleting...")),1)])):(n(),c("div",we,[g((n(),x(d,{as:"a",title:e(t)("View Server Intel"),href:a.route("admin.server.show",r.id),class:"inline-flex items-center justify-center text-primary-500 hover:text-primary-800"},{default:i(()=>[l(e(R),{class:"inline-block w-5 h-5"})]),_:2},1032,["title","href"])),[[f]]),e(m)("update servers")?g((n(),x(d,{key:0,as:"a",href:a.route("admin.server.edit",r.id),class:"inline-flex items-center justify-center text-warning-600 dark:text-warning-500 hover:text-warning-800 dark:hover:text-warning-800",title:e(t)("Edit Server")},{default:i(()=>[l(e(Y),{class:"inline-block w-5 h-5"})]),_:2},1032,["href","title"])),[[f]]):p("",!0),e(m)("delete servers")?g((n(),x(d,{key:1,as:"button",method:"DELETE",href:a.route("admin.server.delete",r.id),class:"inline-flex items-center justify-center text-error-600 hover:text-error-900 focus:outline-none",title:e(t)("Delete Server")},{default:i(()=>[l(e(F),{class:"inline-block w-5 h-5"})]),_:2},1032,["href","title"])),[[S,{title:"Delete Server?",message:"Are you sure you want to delete this Server permanently? Deleting a Server will also delete all of its associated data including all of its Player & Server Intel data. This action cannot be undone."}],[f]]):p("",!0)]))])]}),_:1},8,["data","filters"])])]),_:1})}}};export{Oe as default};
