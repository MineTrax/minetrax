import{o as d,d as m,a as o,r as S,k as N,i as g,s as B,c as w,w as n,b as c,u as s,t as l,K as C,e as p,f as b,m as A,T as H}from"./app-aqw-n-C2.js";import{s as L}from"./vue-multiselect.esm-Doco6gya.js";import{X as v}from"./XInput-DNS1lJmC.js";import{u as U,A as Y}from"./AppLayout-nTzTLkcY.js";import{L as j}from"./LoadingButton-BK0dHmqX.js";import{_}from"./AlertCard-pjpLYWej.js";import{r as M}from"./CheckCircleIcon-BA6v2nZS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-BHJIwx4L.js";import"./useAuthorizable-CKY4A9EI.js";import"./XMarkIcon-Ck8A-WMF.js";function T(y,x){return d(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z","clip-rule":"evenodd"})])}const q={class:"max-w-6xl px-2 py-3 mx-auto space-y-4 md:py-12 md:px-10"},D={class:"flex flex-col md:flex-row md:items-center md:justify-between"},X={key:0,class:"text-lg mb-2 md:mb-0 md:text-2xl font-bold text-secondary-700 dark:text-secondary-200"},Z={key:1,class:"text-lg italic mb-2 md:mb-0 md:text-2xl font-bold text-secondary-500 dark:text-secondary-500"},$={key:0,class:"text-xs text-secondary-500 dark:text-secondary-500"},E={class:"text-xl"},F={class:"text-sm"},G={as:"div",class:"w-full p-6 text-secondary-500 rounded-lg text-medium dark:text-secondary-400 bg-white shadow dark:bg-surface-800"},I={class:"grid grid-cols-6 gap-6"},K={class:"col-span-6 sm:col-span-6 flex space-x-2"},z=["disabled"],J={class:"hidden md:block"},O={class:"col-span-6 sm:col-span-6"},Q={class:"mt-6"},W={key:0,class:"text-sm text-orange-500 dark:text-orange-500 flex mt-2"},ce={__name:"ResetPassword",props:{uuid:{type:String,required:!1},players:{type:Array,required:!0},cooldown:{type:Number},cannotPlayerPasswordReset:{type:Boolean}},setup(y){const{generateRandomString:x,secondsToHMS:k}=U(),i=y;let a=S(i.players[0]);const h=i.players.find(e=>e.uuid===i.uuid);h&&(a.value=h);const t=N({player_uuid:null,new_password:null,new_password_confirmation:null,reason:null}),P=()=>{t.player_uuid=a.value.uuid,t.post(route("reset-player-password.update"),{onSuccess:()=>{t.reset()}})},f=g(()=>t.processing||!a.value||i.cannotPlayerPasswordReset||i.cooldown>0),V=g(()=>{var e,r;return((r=(e=H().props)==null?void 0:e.toast)==null?void 0:r.type)==="success"});return(e,r)=>{const R=B("AppHead");return d(),w(Y,null,{default:n(()=>[c(R,{title:e.__("Reset Player Password")},null,8,["title"]),o("div",q,[o("div",D,[s(a)?(d(),m("h2",X,l(e.__("Reset password for :username",{username:s(a).username})),1)):(d(),m("h2",Z,l(e.__("No Linked Players")),1)),c(s(L),{id:"username",modelValue:s(a),"onUpdate:modelValue":r[0]||(r[0]=u=>C(a)?a.value=u:a=u),class:"w-full md:w-1/3 bg-surface-300 border-secondary-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm dark:bg-surface-900",options:y.players,multiple:!1,placeholder:e.__("Search")+"...",label:"username","allow-empty":!1,"deselect-label":e.__("Can't remove"),"track-by":"id"},null,8,["modelValue","options","placeholder","deselect-label"])]),s(a)?(d(),m("p",$,l(e.__("Player Uuid"))+": "+l(s(a).uuid),1)):p("",!0),V.value?(d(),w(_,{key:1,"text-color":"text-success-800 dark:text-success-500","border-color":"border-success-500"},{icon:n(()=>[c(s(M),{class:"fill-current h-6 w-6 text-success-500 mr-4"})]),body:n(()=>r[4]||(r[4]=[o("p",{class:"text-sm"},l("Your player password has been changed successfully. You can now join the server with new password."),-1)])),default:n(()=>[o("h2",E,l(e.__("Password changed successfully!")),1)]),_:1})):p("",!0),s(a)?p("",!0):(d(),w(_,{key:2,"text-color":"text-error-800 dark:text-error-500","border-color":"border-error-500"},{default:n(()=>[b(l(e.__("No linked players found. Please link a player to your account.")),1)]),_:1})),y.cannotPlayerPasswordReset?(d(),w(_,{key:3,"text-color":"text-error-800 dark:text-error-500","border-color":"border-error-500"},{body:n(()=>[o("p",F,l(e.__("Site administrator has explicitly disabled this feature for your role. Contact for more information.")),1)]),default:n(()=>[b(l(e.__("Your are not allowed to reset your player passwords."))+" ",1)]),_:1})):p("",!0),o("div",G,[o("form",{class:"w-full mt-4",onSubmit:A(P,["prevent"])},[o("div",I,[o("div",K,[c(v,{id:"new_password",modelValue:s(t).new_password,"onUpdate:modelValue":r[1]||(r[1]=u=>s(t).new_password=u),disabled:f.value,label:e.__("New Password"),error:s(t).errors.new_password,type:"text",name:"new_password","help-error-flex":"flex-row"},null,8,["modelValue","disabled","label","error"]),o("div",null,[o("button",{disabled:f.value,type:"button",class:"inline-flex items-center px-4 py-4 bg-white border border-secondary-300 rounded-md font-semibold text-xs text-secondary-700 tracking-widest whitespace-nowrap shadow-sm hover:text-secondary-500 focus:outline-none active:text-secondary-800 active:mt-0.5 active:bg-surface-50 transition ease-in-out duration-150 dark:bg-surface-700 dark:text-secondary-200 dark:border-secondary-800 dark:hover:text-white dark:hover:bg-surface-600 disabled:active:mt-0 disabled:cursor-not-allowed disabled:opacity-50",onClick:r[2]||(r[2]=u=>s(t).new_password=s(x)(16))},[c(s(T),{class:"inline h-5 w-5 mr-1"}),o("span",J,l(e.__("Generate Secure Password")),1)],8,z)])]),o("div",O,[c(v,{id:"reason",modelValue:s(t).reason,"onUpdate:modelValue":r[3]||(r[3]=u=>s(t).reason=u),disabled:f.value,label:e.__("Reason"),error:s(t).errors.reason,type:"text",name:"reason","help-error-flex":"flex-row",help:e.__("Small reason why are you changing the password?")},null,8,["modelValue","disabled","label","error","help"])])]),o("div",Q,[c(j,{loading:s(t).processing,class:"inline-flex justify-center py-3 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-500 hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",disabled:f.value,type:"submit"},{default:n(()=>[b(l(e.__("Reset Player Password")),1)]),_:1},8,["loading","disabled"])]),i.cooldown>0?(d(),m("span",W,l(e.__("You are on a cooldown because you have recently changed your password. Refresh the page and try again after :cooldown.",{cooldown:s(k)(i.cooldown,!0)})),1)):p("",!0)],32)])])]),_:1})}}};export{ce as default};
