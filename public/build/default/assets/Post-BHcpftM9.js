import{o as s,d as u,r as H,n as x,j as r,U as O,h as _,y as q,z as N,c as d,w as n,b as o,a as t,v as P,i as z,t as m,g as y,F as I,l as M,W as S}from"./app-CCKLH5ME.js";import{_ as W}from"./Card-DgOxmuJh.js";import{_ as E}from"./CardContent-pSETb6z5.js";import{c as U}from"./utils-D-KgF5mV.js";import{_ as G}from"./CardHeader-BKihTZEY.js";import{I as p}from"./Icon-DlyfKWQ8.js";import{C as J}from"./Comments-tKQJrbr7.js";import{_ as K}from"./UserDisplayname-CmytMFC0.js";import{u as Q}from"./BaseLayout-EMqiVgMT.js";const R={__name:"CardFooter",props:{class:{type:null,required:!1}},setup(e){const a=e;return(f,k)=>(s(),u("div",{class:x(r(U)("flex items-center p-6 pt-0",a.class))},[H(f.$slots,"default")],2))}},X={class:"flex justify-between"},Y={class:"flex"},Z=["src"],ee={class:"ml-3 mt-0.5"},te={class:"flex"},se=["innerHTML"],oe=["src"],re={class:"flex items-center space-x-6 text-muted-foreground"},ae={class:"group-hover:bg-destructive/10 dark:group-hover:bg-destructive/30 group-hover:text-destructive p-2 rounded-full transition-all duration-200"},ne={class:"ml-1 text-sm font-medium group-hover:text-destructive transition-colors duration-200"},le={class:"group-hover:bg-destructive/10 dark:group-hover:bg-destructive/30 p-2 rounded-full transition-all duration-200"},ie={class:"ml-1 text-sm font-medium transition-colors duration-200"},ue={class:"group-hover:bg-primary/10 group-hover:text-primary p-2 rounded-full transition-all duration-200"},ce={class:"ml-1 text-sm font-medium group-hover:text-primary transition-colors duration-200"},xe={__name:"Post",props:{post:{type:Object,required:!0},commentsSectionOpened:{type:Boolean,default:!1}},setup(e){var w,C,$,T,D;const a=e,{purifyAndLinkifyText:f,formatTimeAgoToNow:k,formatToDayDateString:A}=Q(),b=O(),c=_(((C=(w=a.post.love_reactant)==null?void 0:w.reactions)==null?void 0:C.length)>0),l=_(((D=(T=($=a.post)==null?void 0:$.love_reactant)==null?void 0:T.reaction_total)==null?void 0:D.count)??0),h=_(a.commentsSectionOpened),L=()=>{if(!b.props.auth.user){S.get(route("login"));return}c.value=!0,l.value++,axios.post(route("reaction.post.like",a.post.id)).then(()=>{}).catch(()=>{c.value=!1,l.value--})},V=()=>{if(!b.props.auth.user){S.get(route("login"));return}c.value=!1,l.value--,axios.post(route("reaction.post.unlike",a.post.id)).then(()=>{}).catch(()=>{c.value=!0,l.value++})};return(i,j)=>{const v=q("inertia-link"),B=N("tippy"),F=N("confirm");return s(),d(r(W),{class:"transition-all duration-200 hover:shadow-md"},{default:n(()=>[o(r(G),{class:"pb-3"},{default:n(()=>[t("div",X,[t("div",Y,[t("img",{class:"w-12 h-12 rounded-full ring-2 ring-border",src:e.post.user.profile_photo_url,alt:"profile photo"},null,8,Z),t("div",ee,[o(v,{class:"cursor-pointer hover:underline text-card-foreground transition-colors duration-200",as:"a",href:i.route("user.public.get",e.post.user.username)},{default:n(()=>[o(K,{user:e.post.user,"show-username":!0},null,8,["user"])]),_:1},8,["href"]),t("div",te,[P((s(),d(v,{as:"a",href:i.route("post.show",e.post.id),content:r(A)(e.post.created_at),class:"text-sm font-light leading-snug text-muted-foreground hover:text-primary focus:outline-none transition-colors duration-200"},{default:n(()=>[z(m(r(k)(e.post.created_at)),1)]),_:1},8,["href","content"])),[[B]])])])]),i.$page.props.auth.user&&e.post.permissions.delete?P((s(),d(v,{key:0,title:i.__("Delete Post"),"preserve-scroll":!0,"preserve-state":!1,as:"button",method:"delete",href:i.route("post.delete",e.post.id),class:"text-muted-foreground hover:text-destructive focus:outline-none"},{default:n(()=>[o(p,{name:"trash",class:"h-5 w-5"})]),_:1},8,["title","href"])),[[F,{message:i.__("Are you sure you want to delete this Post?")}],[B]]):y("",!0)])]),_:1}),o(r(E),{class:"pt-0"},{default:n(()=>[t("p",{class:"leading-relaxed text-card-foreground break-words whitespace-pre-line",innerHTML:r(f)(e.post.body)},null,8,se),e.post.media_url_array.length?(s(),u("div",{key:0,class:x(["mt-4 grid gap-3",{"grid-cols-2":e.post.media_url_array.length>1}])},[(s(!0),u(I,null,M(e.post.media_url_array,g=>(s(),u("div",{key:g,class:"relative overflow-hidden rounded-lg border"},[t("img",{src:g,alt:"Attachment",class:x(["object-cover w-full h-full transition-transform duration-200 hover:scale-105",e.post.media_url_array.length>1?"max-h-56":"max-h-96"])},null,10,oe)]))),128))],2)):y("",!0)]),_:1}),o(r(R),{class:"pt-0 justify-end"},{default:n(()=>[t("div",re,[c.value?(s(),u("button",{key:1,class:"flex items-center text-destructive cursor-pointer group",onClick:V},[t("span",le,[o(p,{name:"heart-fill",class:"w-5 h-5"})]),t("span",ie,m(l.value),1)])):(s(),u("button",{key:0,class:"flex items-center cursor-pointer group",onClick:L},[t("span",ae,[o(p,{name:"heart-hollow",class:"h-5 w-5"})]),t("span",ne,m(l.value),1)])),t("button",{class:"flex items-center cursor-pointer group",onClick:j[0]||(j[0]=g=>h.value=!h.value)},[t("span",ue,[o(p,{name:"comment",class:"h-5 w-5"})]),t("span",ce,m(e.post.comments_count),1)])])]),_:1}),h.value?(s(),d(J,{key:0,commentable:e.post,"commentable-type":"post"},null,8,["commentable"])):y("",!0)]),_:1})}}};export{xe as _};
