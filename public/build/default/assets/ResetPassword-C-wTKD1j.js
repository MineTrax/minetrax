import{o as d,d as m,a as r,r as S,k as N,i as x,s as B,c as f,w as n,b as c,u as o,t as l,K as C,e as p,f as g,m as A,T as H}from"./app-CKBhx7zV.js";import{s as L}from"./vue-multiselect.esm-BuT5B9vu.js";import{X as v}from"./XInput-ClJh1Lz8.js";import{u as U,A as Y}from"./AppLayout-CR1QU6uX.js";import{L as j}from"./LoadingButton-cdNAmWwn.js";import{_ as b}from"./AlertCard-DM988dMb.js";import{r as M}from"./CheckCircleIcon-C6RGv9o7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-3FFVVDHc.js";import"./useAuthorizable-BBfNqKKU.js";import"./XMarkIcon-CiCHBMsR.js";function T(y,_){return d(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z","clip-rule":"evenodd"})])}const q={class:"max-w-6xl px-2 py-3 mx-auto space-y-4 md:py-12 md:px-10"},D={class:"flex flex-col md:flex-row md:items-center md:justify-between"},X={key:0,class:"text-lg mb-2 md:mb-0 md:text-2xl font-bold text-gray-700 dark:text-gray-200"},Z={key:1,class:"text-lg italic mb-2 md:mb-0 md:text-2xl font-bold text-gray-500 dark:text-gray-500"},$={key:0,class:"text-xs text-gray-500 dark:text-gray-500"},E={class:"text-xl"},F={class:"text-sm"},G={as:"div",class:"w-full p-6 text-gray-500 rounded-lg text-medium dark:text-gray-400 bg-white shadow dark:bg-gray-800"},I={class:"grid grid-cols-6 gap-6"},K={class:"col-span-6 sm:col-span-6 flex space-x-2"},z=["disabled"],J={class:"hidden md:block"},O={class:"col-span-6 sm:col-span-6"},Q={class:"mt-6"},W={key:0,class:"text-sm text-orange-500 dark:text-orange-500 flex mt-2"},ce={__name:"ResetPassword",props:{uuid:{type:String,required:!1},players:{type:Array,required:!0},cooldown:{type:Number},cannotPlayerPasswordReset:{type:Boolean}},setup(y){const{generateRandomString:_,secondsToHMS:k}=U(),i=y;let a=S(i.players[0]);const h=i.players.find(e=>e.uuid===i.uuid);h&&(a.value=h);const t=N({player_uuid:null,new_password:null,new_password_confirmation:null,reason:null}),P=()=>{t.player_uuid=a.value.uuid,t.post(route("reset-player-password.update"),{onSuccess:()=>{t.reset()}})},w=x(()=>t.processing||!a.value||i.cannotPlayerPasswordReset||i.cooldown>0),V=x(()=>{var e,s;return((s=(e=H().props)==null?void 0:e.toast)==null?void 0:s.type)==="success"});return(e,s)=>{const R=B("AppHead");return d(),f(Y,null,{default:n(()=>[c(R,{title:e.__("Reset Player Password")},null,8,["title"]),r("div",q,[r("div",D,[o(a)?(d(),m("h2",X,l(e.__("Reset password for :username",{username:o(a).username})),1)):(d(),m("h2",Z,l(e.__("No Linked Players")),1)),c(o(L),{id:"username",modelValue:o(a),"onUpdate:modelValue":s[0]||(s[0]=u=>C(a)?a.value=u:a=u),class:"w-full md:w-1/3 bg-gray-300 border-gray-300 rounded-md shadow-sm focus:ring-light-blue-500 focus:border-light-blue-500 sm:text-sm dark:bg-gray-900",options:y.players,multiple:!1,placeholder:e.__("Search")+"...",label:"username","allow-empty":!1,"deselect-label":e.__("Can't remove"),"track-by":"id"},null,8,["modelValue","options","placeholder","deselect-label"])]),o(a)?(d(),m("p",$,l(e.__("Player Uuid"))+": "+l(o(a).uuid),1)):p("",!0),V.value?(d(),f(b,{key:1,"text-color":"text-green-800 dark:text-green-500","border-color":"border-green-500"},{icon:n(()=>[c(o(M),{class:"fill-current h-6 w-6 text-green-500 mr-4"})]),body:n(()=>s[4]||(s[4]=[r("p",{class:"text-sm"},l("Your player password has been changed successfully. You can now join the server with new password."),-1)])),default:n(()=>[r("h2",E,l(e.__("Password changed successfully!")),1)]),_:1})):p("",!0),o(a)?p("",!0):(d(),f(b,{key:2,"text-color":"text-red-800 dark:text-red-500","border-color":"border-red-500"},{default:n(()=>[g(l(e.__("No linked players found. Please link a player to your account.")),1)]),_:1})),y.cannotPlayerPasswordReset?(d(),f(b,{key:3,"text-color":"text-red-800 dark:text-red-500","border-color":"border-red-500"},{body:n(()=>[r("p",F,l(e.__("Site administrator has explicitly disabled this feature for your role. Contact for more information.")),1)]),default:n(()=>[g(l(e.__("Your are not allowed to reset your player passwords."))+" ",1)]),_:1})):p("",!0),r("div",G,[r("form",{class:"w-full mt-4",onSubmit:A(P,["prevent"])},[r("div",I,[r("div",K,[c(v,{id:"new_password",modelValue:o(t).new_password,"onUpdate:modelValue":s[1]||(s[1]=u=>o(t).new_password=u),disabled:w.value,label:e.__("New Password"),error:o(t).errors.new_password,type:"text",name:"new_password","help-error-flex":"flex-row"},null,8,["modelValue","disabled","label","error"]),r("div",null,[r("button",{disabled:w.value,type:"button",class:"inline-flex items-center px-4 py-4 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 tracking-widest whitespace-nowrap shadow-sm hover:text-gray-500 focus:outline-none active:text-gray-800 active:mt-0.5 active:bg-gray-50 transition ease-in-out duration-150 dark:bg-cool-gray-700 dark:text-gray-200 dark:border-gray-800 dark:hover:text-white dark:hover:bg-cool-gray-600 disabled:active:mt-0 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[2]||(s[2]=u=>o(t).new_password=o(_)(16))},[c(o(T),{class:"inline h-5 w-5 mr-1"}),r("span",J,l(e.__("Generate Secure Password")),1)],8,z)])]),r("div",O,[c(v,{id:"reason",modelValue:o(t).reason,"onUpdate:modelValue":s[3]||(s[3]=u=>o(t).reason=u),disabled:w.value,label:e.__("Reason"),error:o(t).errors.reason,type:"text",name:"reason","help-error-flex":"flex-row",help:e.__("Small reason why are you changing the password?")},null,8,["modelValue","disabled","label","error","help"])])]),r("div",Q,[c(j,{loading:o(t).processing,class:"inline-flex justify-center py-3 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-light-blue-500 hover:bg-light-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-light-blue-500 disabled:opacity-50",disabled:w.value,type:"submit"},{default:n(()=>[g(l(e.__("Reset Player Password")),1)]),_:1},8,["loading","disabled"])]),i.cooldown>0?(d(),m("span",W,l(e.__("You are on a cooldown because you have recently changed your password. Refresh the page and try again after :cooldown.",{cooldown:o(k)(i.cooldown,!0)})),1)):p("",!0)],32)])])]),_:1})}}};export{ce as default};
