import{h as w,e as s,C as G,L as q,o as i,d as u,c as W,w as j,i as L,t as d,g as m,n,j as p,a as o,f as g,b as U}from"./app-Bh5uq5T2.js";import{b as J}from"./index-BlQc97mu.js";import{c as v}from"./utils-D-KgF5mV.js";import{_ as A}from"./Label-Ba68SC45.js";import{_ as M}from"./index-Bvduyk2Y.js";import{I as H}from"./Icon-B54a8he6.js";const K={key:0,class:"text-destructive ml-1"},Q=["disabled"],X=["src"],Y={class:"text-center space-y-1"},Z={class:"text-sm font-medium"},_={class:"text-xs text-muted-foreground"},ee=["disabled","aria-label"],te=["id","name","accept","disabled"],le={key:0,class:"text-xs text-muted-foreground"},ae={key:1,class:"text-xs text-destructive"},ce={__name:"ImageUpload",props:{modelValue:{type:[File,Object,String,null],default:null},currentUrl:{type:String,default:""},label:String,name:String,id:String,error:String,help:String,hint:{type:String,default:"PNG, JPG, GIF up to 2MB"},required:{type:[Boolean,String],default:!1},disabled:{type:[Boolean,String],default:!1},accept:{type:String,default:"image/*"},maxSizeMb:{type:Number,default:2},shape:{type:String,default:"rect"},previewClass:{type:String,default:""},divClass:{type:String,default:""},helpErrorFlex:{type:String,default:"flex-col"},removable:{type:Boolean,default:!0},uploadLabel:{type:String,default:"Upload"},changeLabel:{type:String,default:"Change"},clearLabel:{type:String,default:"Clear"},removeLabel:{type:String,default:"Remove"},showRemoveIcon:{type:Boolean,default:!0},objectFit:{type:String,default:"cover"}},emits:["update:modelValue","remove"],setup(e,{emit:R}){const a=e,z=R,F=w(null),y=w(!1),x=w(""),r=w(""),c=J(a,"modelValue",z,{passive:!0}),S=s(()=>c.value instanceof File),f=s(()=>x.value||a.error),h=s(()=>a.shape==="circle"?"rounded-full":"rounded-md"),k=s(()=>a.previewClass||(a.shape==="circle"?"h-28 w-28":"h-28 w-full")),V=s(()=>v("relative overflow-hidden",k.value,h.value)),I=s(()=>({cover:"object-cover",contain:"object-contain",fill:"object-fill",none:"object-none","scale-down":"object-scale-down"})[a.objectFit]||"object-cover"),D=s(()=>v("absolute inset-0 h-full w-full",I.value,h.value)),$=s(()=>v("relative flex items-center justify-center border-2 border-dashed text-muted-foreground/80 bg-muted/30 hover:bg-muted/50 transition-colors",y.value?"border-primary/60":"border-border",k.value,h.value)),N=s(()=>a.hint),B=s(()=>r.value?r.value:a.currentUrl||""),E=s(()=>a.shape==="circle"?"-top-2 -right-2":"top-2 right-2");G(c,(t,l)=>{if(x.value="",r.value&&(URL.revokeObjectURL(r.value),r.value=""),t instanceof File){if(!t.type.startsWith("image/")){x.value="Invalid file type. Please select an image.",c.value=null;return}if(t.size/(1024*1024)>a.maxSizeMb){x.value=`File too large (>${a.maxSizeMb}MB).`,c.value=null;return}r.value=URL.createObjectURL(t)}}),q(()=>{r.value&&URL.revokeObjectURL(r.value)});const C=()=>{var t;a.disabled||(t=F.value)==null||t.click()},O=t=>{const l=t.target.files&&t.target.files[0];l&&(c.value=l,t.target.value="")},P=t=>{var b;y.value=!1;const l=(b=t.dataTransfer)==null?void 0:b.files;!l||l.length===0||(c.value=l[0])},T=()=>{c.value=null};return(t,l)=>(i(),u("div",{class:n(p(v)("space-y-2",e.divClass))},[e.label?(i(),W(p(A),{key:0,for:e.id,class:n(p(v)("text-sm font-medium",f.value?"text-destructive":"text-foreground"))},{default:j(()=>[L(d(e.label)+" ",1),e.required?(i(),u("span",K,"*")):m("",!0)]),_:1},8,["for","class"])):m("",!0),o("div",{class:n(["group relative",p(v)("w-full",k.value)])},[o("button",{type:"button",class:"block w-full h-full focus:outline-none",onClick:C,onDragover:l[0]||(l[0]=g(b=>y.value=!0,["prevent"])),onDragleave:l[1]||(l[1]=g(b=>y.value=!1,["prevent"])),onDrop:g(P,["prevent"]),disabled:e.disabled},[B.value?(i(),u("div",{key:0,class:n(V.value)},[o("img",{src:B.value,alt:"preview",class:n(D.value)},null,10,X),o("div",{class:n(["absolute inset-0 flex md:hidden items-center justify-center gap-2 bg-black/40 text-white",h.value])},[U(M,{size:"sm",variant:"secondary",type:"button",disabled:e.disabled,onClick:g(C,["stop","prevent"])},{default:j(()=>[L(d(e.changeLabel),1)]),_:1},8,["disabled"])],2),o("div",{class:n(["absolute inset-0 hidden md:flex items-center justify-center gap-2 bg-black/40 text-white rounded-md md:opacity-0 md:pointer-events-none md:group-hover:opacity-100 md:group-hover:pointer-events-auto transition-opacity",h.value])},[U(M,{size:"sm",variant:"secondary",type:"button",disabled:e.disabled,onClick:g(C,["stop","prevent"])},{default:j(()=>[L(d(e.changeLabel),1)]),_:1},8,["disabled"])],2)],2)):(i(),u("div",{key:1,class:n($.value)},[o("div",Y,[o("div",Z,d(e.uploadLabel),1),o("div",_,d(N.value),1)])],2))],40,Q),e.showRemoveIcon&&(S.value||e.removable&&e.currentUrl)?(i(),u("button",{key:0,type:"button",disabled:e.disabled,class:n(["absolute z-20 inline-flex items-center justify-center rounded-full bg-black/50 text-white hover:bg-black/70 disabled:opacity-60 disabled:cursor-not-allowed focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white w-6 h-6 p-1",E.value]),"aria-label":S.value?e.clearLabel:e.removeLabel,onClick:l[2]||(l[2]=g(b=>S.value?T():t.$emit("remove"),["stop","prevent"]))},[U(H,{name:S.value?"close":"trash"},null,8,["name"])],10,ee)):m("",!0),o("input",{ref_key:"fileInputRef",ref:F,type:"file",class:"hidden",id:e.id,name:e.name,accept:e.accept,disabled:e.disabled,onChange:O},null,40,te)],2),e.help||f.value?(i(),u("div",{key:1,class:n(["flex gap-1",p(v)(e.help&&f.value?"justify-between":f.value?"justify-end":"justify-start",e.helpErrorFlex)])},[e.help?(i(),u("p",le,d(e.help),1)):m("",!0),f.value?(i(),u("p",ae,d(f.value),1)):m("",!0)],2)):m("",!0)],2))}};export{ce as _};
