import{r as R,i as g,A as de,B as D,C as I,j as F,D as J,u as r,E as z,G as O,H as ue,I as Y,F as ce,k as pe,s as me,c as fe,w as V,o as T,b as k,a as n,t as h,m as ve,f as $,n as L,d as N,e as A,q as ye,J as be}from"./app-aqw-n-C2.js";import{_ as ge}from"./AdminLayout-CgKpHlNL.js";import{L as he}from"./LoadingButton-BK0dHmqX.js";import{X as xe}from"./XInput-DNS1lJmC.js";import{X as _e}from"./XSelect-DOma4F-T.js";import{X as ke}from"./XCheckbox-0UxYju6b.js";import{s as X}from"./vue-multiselect.esm-Doco6gya.js";import{i as we}from"./index.es-DmF2I_dF.js";import{_ as Re}from"./InputError-3bUb8ssO.js";import{i as q,A as M,o as U,E as Se,T as Ee,a as C}from"./keyboard-D9MjfX7e.js";import{i as j,O as Oe,f as Ve,u as Ce,P as H,N as P,T as K}from"./hidden-DyfrtWB5.js";import"./AppLayout-nTzTLkcY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-BHJIwx4L.js";import"./useAuthorizable-CKY4A9EI.js";import"./open-closed-BVqjHboy.js";import"./CloudArrowDownIcon-D455bD1C.js";import"./index-LiBbe_Xz.js";function Te(e,a,l){let s=R(l==null?void 0:l.value),i=g(()=>e.value!==void 0);return[g(()=>i.value?e.value:s.value),function(c){return i.value||(s.value=c),a==null?void 0:a(c)}]}function $e({container:e,accept:a,walk:l,enabled:s}){de(()=>{let i=e.value;if(!i||s!==void 0&&!s.value)return;let c=j(e);if(!c)return;let t=Object.assign(v=>a(v),{acceptNode:a}),y=c.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1);for(;y.nextNode();)l(y.currentNode)})}function Q(e={},a=null,l=[]){for(let[s,i]of Object.entries(e))ee(l,Z(a,s),i);return l}function Z(e,a){return e?e+"["+a+"]":a}function ee(e,a,l){if(Array.isArray(l))for(let[s,i]of l.entries())ee(e,Z(a,s.toString()),i);else l instanceof Date?e.push([a,l.toISOString()]):typeof l=="boolean"?e.push([a,l?"1":"0"]):typeof l=="string"?e.push([a,l]):typeof l=="number"?e.push([a,`${l}`]):l==null?e.push([a,""]):Q(l,a,e)}function Le(e){var a,l;let s=(a=e==null?void 0:e.form)!=null?a:e.closest("form");if(s){for(let i of s.elements)if(i!==e&&(i.tagName==="INPUT"&&i.type==="submit"||i.tagName==="BUTTON"&&i.type==="submit"||i.nodeName==="INPUT"&&i.type==="image")){i.click();return}(l=s.requestSubmit)==null||l.call(s)}}let Ne=Symbol("DescriptionContext");function ae({slot:e=R({}),name:a="Description",props:l={}}={}){let s=R([]);function i(c){return s.value.push(c),()=>{let t=s.value.indexOf(c);t!==-1&&s.value.splice(t,1)}}return D(Ne,{register:i,slot:e,name:a,props:l}),g(()=>s.value.length>0?s.value.join(" "):void 0)}let re=Symbol("LabelContext");function te(){let e=z(re,null);if(e===null){let a=new Error("You used a <Label /> component, but it is not inside a parent.");throw Error.captureStackTrace&&Error.captureStackTrace(a,te),a}return e}function oe({slot:e={},name:a="Label",props:l={}}={}){let s=R([]);function i(c){return s.value.push(c),()=>{let t=s.value.indexOf(c);t!==-1&&s.value.splice(t,1)}}return D(re,{register:i,slot:e,name:a,props:l}),g(()=>s.value.length>0?s.value.join(" "):void 0)}let Ae=I({name:"Label",props:{as:{type:[Object,String],default:"label"},passive:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{slots:a,attrs:l}){var s;let i=(s=e.id)!=null?s:`headlessui-label-${q()}`,c=te();return F(()=>J(c.register(i))),()=>{let{name:t="Label",slot:y={},props:v={}}=c,{passive:w,...S}=e,m={...Object.entries(v).reduce((d,[x,u])=>Object.assign(d,{[x]:r(u)}),{}),id:i};return w&&(delete m.onClick,delete m.htmlFor,delete S.onClick),M({ourProps:m,theirProps:S,slot:y,attrs:l,slots:a,name:t})}}});function Pe(e,a){return e===a}let le=Symbol("RadioGroupContext");function se(e){let a=z(le,null);if(a===null){let l=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,se),l}return a}let je=I({name:"RadioGroup",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>Pe},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},id:{type:String,default:null}},inheritAttrs:!1,setup(e,{emit:a,attrs:l,slots:s,expose:i}){var c;let t=(c=e.id)!=null?c:`headlessui-radiogroup-${q()}`,y=R(null),v=R([]),w=oe({name:"RadioGroupLabel"}),S=ae({name:"RadioGroupDescription"});i({el:y,$el:y});let[m,d]=Te(g(()=>e.modelValue),o=>a("update:modelValue",o),g(()=>e.defaultValue)),x={options:v,value:m,disabled:g(()=>e.disabled),firstOption:g(()=>v.value.find(o=>!o.propsRef.disabled)),containsCheckedOption:g(()=>v.value.some(o=>x.compare(O(o.propsRef.value),O(e.modelValue)))),compare(o,f){if(typeof e.by=="string"){let p=e.by;return(o==null?void 0:o[p])===(f==null?void 0:f[p])}return e.by(o,f)},change(o){var f;if(e.disabled||x.compare(O(m.value),O(o)))return!1;let p=(f=v.value.find(_=>x.compare(O(_.propsRef.value),O(o))))==null?void 0:f.propsRef;return p!=null&&p.disabled?!1:(d(o),!0)},registerOption(o){v.value.push(o),v.value=Oe(v.value,f=>f.element)},unregisterOption(o){let f=v.value.findIndex(p=>p.id===o);f!==-1&&v.value.splice(f,1)}};D(le,x),$e({container:g(()=>U(y)),accept(o){return o.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:o.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(o){o.setAttribute("role","none")}});function u(o){if(!y.value||!y.value.contains(o.target))return;let f=v.value.filter(p=>p.propsRef.disabled===!1).map(p=>p.element);switch(o.key){case C.Enter:Le(o.currentTarget);break;case C.ArrowLeft:case C.ArrowUp:if(o.preventDefault(),o.stopPropagation(),H(f,P.Previous|P.WrapAround)===K.Success){let p=v.value.find(_=>{var b;return _.element===((b=j(y))==null?void 0:b.activeElement)});p&&x.change(p.propsRef.value)}break;case C.ArrowRight:case C.ArrowDown:if(o.preventDefault(),o.stopPropagation(),H(f,P.Next|P.WrapAround)===K.Success){let p=v.value.find(_=>{var b;return _.element===((b=j(_.element))==null?void 0:b.activeElement)});p&&x.change(p.propsRef.value)}break;case C.Space:{o.preventDefault(),o.stopPropagation();let p=v.value.find(_=>{var b;return _.element===((b=j(_.element))==null?void 0:b.activeElement)});p&&x.change(p.propsRef.value)}break}}let E=g(()=>{var o;return(o=U(y))==null?void 0:o.closest("form")});return F(()=>{ue([E],()=>{if(!E.value||e.defaultValue===void 0)return;function o(){x.change(e.defaultValue)}return E.value.addEventListener("reset",o),()=>{var f;(f=E.value)==null||f.removeEventListener("reset",o)}},{immediate:!0})}),()=>{let{disabled:o,name:f,form:p,..._}=e,b={ref:y,id:t,role:"radiogroup","aria-labelledby":w.value,"aria-describedby":S.value,onKeydown:u};return Y(ce,[...f!=null&&m.value!=null?Q({[f]:m.value}).map(([B,G])=>Y(Ve,Se({features:Ce.Hidden,key:B,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:p,disabled:o,name:B,value:G}))):[],M({ourProps:b,theirProps:{...l,...Ee(_,["modelValue","defaultValue","by"])},slot:{},attrs:l,slots:s,name:"RadioGroup"})])}}});var Ue=(e=>(e[e.Empty=1]="Empty",e[e.Active=2]="Active",e))(Ue||{});let W=I({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{attrs:a,slots:l,expose:s}){var i;let c=(i=e.id)!=null?i:`headlessui-radiogroup-option-${q()}`,t=se("RadioGroupOption"),y=oe({name:"RadioGroupLabel"}),v=ae({name:"RadioGroupDescription"}),w=R(null),S=g(()=>({value:e.value,disabled:e.disabled})),m=R(1);s({el:w,$el:w});let d=g(()=>U(w));F(()=>t.registerOption({id:c,element:d,propsRef:S})),J(()=>t.unregisterOption(c));let x=g(()=>{var b;return((b=t.firstOption.value)==null?void 0:b.id)===c}),u=g(()=>t.disabled.value||e.disabled),E=g(()=>t.compare(O(t.value.value),O(e.value))),o=g(()=>u.value?-1:E.value||!t.containsCheckedOption.value&&x.value?0:-1);function f(){var b;t.change(e.value)&&(m.value|=2,(b=U(w))==null||b.focus())}function p(){m.value|=2}function _(){m.value&=-3}return()=>{let{value:b,disabled:B,...G}=e,ne={checked:E.value,disabled:u.value,active:!!(m.value&2)},ie={id:c,ref:w,role:"radio","aria-checked":E.value?"true":"false","aria-labelledby":y.value,"aria-describedby":v.value,"aria-disabled":u.value?!0:void 0,tabIndex:o.value,onClick:u.value?void 0:f,onFocus:u.value?void 0:p,onBlur:u.value?void 0:_};return M({ourProps:ie,theirProps:G,slot:ne,attrs:a,slots:l,name:"RadioGroupOption"})}}}),Be=Ae;const Ge={class:"max-w-6xl px-10 py-12 mx-auto"},De={class:"flex justify-between mb-8"},Ie={class:"text-3xl font-bold text-secondary-500 dark:text-secondary-300"},Fe={class:"mt-10 sm:mt-0"},qe={class:"mt-5 md:mt-0 md:col-span-2"},Me={class:"shadow sm:rounded-md"},Ye={class:"px-4 py-5 bg-white dark:bg-surface-800 sm:p-6"},Xe={class:"grid grid-cols-6 gap-6"},He={class:"col-span-6 sm:col-span-6"},Ke={class:"flex items-center justify-center"},We=["checked"],Je={class:"ms-2"},ze={class:"flex items-center justify-center"},Qe=["checked"],Ze={class:"ms-2"},ea={class:"col-span-6 sm:col-span-6"},aa={class:"mb-2 text-secondary-700 dark:text-secondary-300 font-semibold"},ra={class:"text-sm text-error-500 mt-0.5"},ta={class:"col-span-6 sm:col-span-6"},oa={key:0,class:"flex flex-col items-end mb-2"},la={class:"text-secondary-700 dark:text-secondary-300 text-sm font-semibold"},sa={class:"text-sm text-right text-secondary-600 dark:text-secondary-400"},na={class:"col-span-6 sm:col-span-6 relative"},ia={for:"execute_at",class:"absolute -top-2.5 left-0 px-3 py-5 text-xs text-secondary-500 h-full pointer-events-none transform origin-left transition-all duration-100 ease-in-out"},da={key:0,class:"col-span-6 sm:col-span-6"},ua={key:1,class:"col-span-6 sm:col-span-6"},ca={class:"mb-2 text-secondary-700 dark:text-secondary-300 font-semibold"},pa={class:"text-sm text-error-500 mt-0.5"},ma={key:2,class:"col-span-6 sm:col-span-6"},fa={class:"flex justify-end px-4 py-3 bg-surface-50 dark:bg-surface-800 sm:px-6"},Na={__name:"CreateCommandQueue",props:{servers:{type:Array}},setup(e){const{__:a}=ye(),l={all:"All - for every player in the web",linked:"Linked Only - for every player who are linked to a user account",unlinked:"Unlinked Only - for every player who are not linked to a user account",custom:"Custom - select players from dropdown"},s=R([]),i=R(!1);let c=null;const t=pe({scope:"global",command:"",execute_at:null,servers:[],players:{scope:"all",is_player_online_required:!1,id:[]}});function y({name:m,hostname:d}){return`${m} - ${d}`}function v({username:m,uuid:d}){return`${m} - ${d}`}const w=m=>{if(c&&clearTimeout(c),!m||m.length<2){s.value=[];return}c=setTimeout(async()=>{i.value=!0;try{const d=await be.get("/stats",{params:{"filter[q]":m}});s.value=d.data.data||d.data||[]}catch(d){console.error("Error searching players:",d),s.value=[]}finally{i.value=!1}},300)},S=()=>{t.post(route("admin.command-queue.store"),{preserveScroll:!0,onSuccess:()=>{t.reset("command","servers","players","execute_at")}})};return(m,d)=>{const x=me("app-head");return T(),fe(ge,null,{default:V(()=>[k(x,{title:"Run Command"}),n("div",Ge,[n("div",De,[n("h1",Ie,h(r(a)("Run Command")),1)]),n("div",Fe,[n("div",qe,[n("form",{onSubmit:ve(S,["prevent"])},[n("div",Me,[n("div",Ye,[n("div",Xe,[n("div",He,[k(r(je),{modelValue:r(t).scope,"onUpdate:modelValue":d[0]||(d[0]=u=>r(t).scope=u),class:"flex justify-between gap-2"},{default:V(()=>[k(r(Be),{class:"flex items-center flex-none w-1/12 font-semibold text-secondary-700 dark:text-secondary-300"},{default:V(()=>[$(h(r(a)("Scope")),1)]),_:1}),k(r(W),{class:"flex-1 text-sm text-center uppercase",value:"global"},{default:V(({checked:u})=>[n("div",{class:L(["p-3 rounded shadow-sm cursor-pointer",u?"dark:bg-surface-900 dark:text-secondary-200 font-bold bg-primary-400 text-white":"dark:bg-surface-600 dark:text-secondary-300 bg-surface-200 text-secondary-700"])},[n("div",Ke,[n("input",{checked:u,type:"radio",disabled:"",class:"w-4 h-4 bg-surface-100 border-secondary-300 text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-secondary-800 focus:ring-2 dark:bg-surface-700 dark:border-secondary-600"},null,8,We),n("label",Je,h(r(a)("Global")),1)]),n("div",null,[n("span",{class:L([u?"text-secondary-200 dark:text-secondary-400":"text-secondary-400","text-xs"])},h(r(a)("Run generic command")),3)])],2)]),_:1}),k(r(W),{class:"flex-1 text-sm text-center uppercase",value:"player"},{default:V(({checked:u})=>[n("div",{class:L(["p-3 rounded shadow-sm cursor-pointer",u?"dark:bg-surface-900 dark:text-secondary-200 font-bold bg-primary-400 text-white":"dark:bg-surface-600 dark:text-secondary-300 bg-surface-200 text-secondary-700"])},[n("div",ze,[n("input",{checked:u,type:"radio",disabled:"",class:"w-4 h-4 bg-surface-100 border-secondary-300 text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-secondary-800 focus:ring-2 dark:bg-surface-700 dark:border-secondary-600"},null,8,Qe),n("label",Ze,h(r(a)("Player")),1)]),n("div",null,[n("span",{class:L([u?"text-secondary-200 dark:text-secondary-400":"text-secondary-400","text-xs"])},h(r(a)("Run against players")),3)])],2)]),_:1})]),_:1},8,["modelValue"])]),n("div",ea,[n("p",aa,h(r(a)("Servers to run on")),1),k(r(X),{modelValue:r(t).servers,"onUpdate:modelValue":d[1]||(d[1]=u=>r(t).servers=u),class:"block w-full border-secondary-900 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",options:e.servers,"custom-label":y,"track-by":"id",multiple:!0,"close-on-select":!1,"clear-on-select":!1,searchable:!1,placeholder:r(a)("Leave empty to run on all servers")+"..."},null,8,["modelValue","options","placeholder"]),n("p",ra,h(r(t).errors.servers),1)]),n("div",ta,[r(t).scope==="player"?(T(),N("div",oa,[n("h3",la,h(r(a)("Available Placeholders")),1),n("ol",sa,[n("li",null,[d[7]||(d[7]=n("code",{class:"text-sm bg-surface-100 dark:bg-surface-700 dark:text-secondary-300 p-1 rounded-md"},"{PLAYER_USERNAME}",-1)),$(" - "+h(r(a)("Username of the player.")),1)]),n("li",null,[d[8]||(d[8]=n("code",{class:"text-sm bg-surface-100 dark:bg-surface-700 dark:text-secondary-300 p-1 rounded-md"},"{PLAYER_UUID}",-1)),$(" - "+h(r(a)("Unique Id of the player.")),1)])])])):A("",!0),k(xe,{id:"command",modelValue:r(t).command,"onUpdate:modelValue":d[2]||(d[2]=u=>r(t).command=u),label:r(a)("Enter command to run..."),error:r(t).errors.command,type:"text",name:"command",help:r(t).scope=="player"?r(a)("Eg: give {PLAYER_USERNAME} diamond 64"):r(a)("Eg: broadcast Hello world!"),"help-error-flex":"flex-row"},null,8,["modelValue","label","error","help"])]),n("div",na,[k(r(we),{id:"execute_at",value:r(t).execute_at,"onUpdate:value":d[3]||(d[3]=u=>r(t).execute_at=u),placeholder:r(a)("Leave empty to run immediately without any delay")+"...",class:"w-full","value-type":"date",type:"datetime",format:"YYYY-MM-DD hh:mm:ss A","input-class":"border-secondary-300 h-14 p-3 text-sm pt-7 focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 rounded-md block w-full dark:bg-surface-900 dark:text-secondary-300 dark:border-secondary-900"},null,8,["value","placeholder"]),n("label",ia,h(r(a)("Run at")),1),k(Re,{message:r(t).errors.execute_at,class:"mt-2"},null,8,["message"])]),r(t).scope==="player"?(T(),N("div",da,[k(_e,{id:"players.scope",modelValue:r(t).players.scope,"onUpdate:modelValue":d[4]||(d[4]=u=>r(t).players.scope=u),error:r(t).errors["players.scope"],name:"players.scope",label:r(a)("Players to run on"),"select-list":l},null,8,["modelValue","error","label"])])):A("",!0),r(t).players.scope==="custom"&&r(t).scope==="player"?(T(),N("div",ua,[n("p",ca,h(r(a)("Select players")),1),k(r(X),{modelValue:r(t).players.id,"onUpdate:modelValue":d[5]||(d[5]=u=>r(t).players.id=u),class:"block w-full border-secondary-900 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",options:s.value,"custom-label":v,"track-by":"id",multiple:!0,"close-on-select":!1,"clear-on-select":!1,searchable:!0,"hide-selected":!0,loading:i.value,"internal-search":!1,onSearchChange:w,placeholder:r(a)("Type to search players")+"...","no-options":r(a)("Type at least 2 characters to search")},null,8,["modelValue","options","loading","placeholder","no-options"]),n("p",pa,h(r(t).errors["players.id"]),1)])):A("",!0),r(t).scope==="player"?(T(),N("div",ma,[k(ke,{id:"players.is_player_online_required",modelValue:r(t).players.is_player_online_required,"onUpdate:modelValue":d[6]||(d[6]=u=>r(t).players.is_player_online_required=u),label:r(a)("Require player to be online"),help:r(a)("This command should only run if player is online on running server. If not online it will be queued to run when player comes online."),name:"players.is_player_online_required",error:r(t).errors["players.is_player_online_required"]},null,8,["modelValue","label","help","error"])])):A("",!0)])]),n("div",fa,[k(he,{loading:r(t).processing,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-success-500 hover:bg-success-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-success-500 disabled:opacity-50",type:"submit"},{default:V(()=>[$(h(r(t).execute_at?r(a)("Schedule Command"):r(a)("Run Command")),1)]),_:1},8,["loading"])])])],32)])])])]),_:1})}}};export{Na as default};
