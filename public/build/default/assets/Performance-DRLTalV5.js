import{h as g,e as I,p as O,o as x,c as L,w as b,b as n,j as t,a as s,i,t as e,B as T,s as $,A as F,d as k,_ as j,g as N}from"./app-Ia0bJDXi.js";import{_ as G}from"./AdminLayout-CJ_PtlCd.js";import{_ as R}from"./AppBreadcrumb-D-yy1VJY.js";import{_ as V}from"./Chart-pbeg9Upg.js";import{i as U}from"./index.es-CCcY1w6y.js";import{I as u}from"./Icon-BR_JXAZL.js";import{_ as P}from"./Card-xSJBqBdx.js";import{_ as S}from"./CardContent-CE_SpfjF.js";import{s as y,b as Y,u as q}from"./BaseLayout-CyMXUReW.js";import{e as v,s as M,a as B,b as A,c as z}from"./subMonths-B0qqqeZO.js";import{L as E}from"./LoadingSpinner-r7xua1a_.js";import{_ as H}from"./ServerIntelServerSelector-B57V_ciX.js";import{_ as W}from"./AlertCard-DZGSGYW7.js";import"./useAuthorizable-Buizf3Yh.js";import"./CloudArrowDownIcon-vObJWmJX.js";import"./index-5qxomotu.js";import"./utils-D-KgF5mV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useForwardPropsEmits-WVrHBpLe.js";import"./chevron-down-CtjWoryU.js";import"./Teleport-DSkR7jkG.js";import"./VisuallyHidden-Cc6JWPqo.js";import"./x-BUMdF8YT.js";import"./XSelect-CAfXjSv2.js";import"./Label-DZbOjpU-.js";import"./SelectValue-CsA2ftb2.js";import"./useFormControl-D3_NwxXr.js";import"./XMarkIcon-aRZJoNuL.js";const Z={class:"flex justify-between items-center"},K={class:"font-extrabold text-foreground flex items-center"},J={__name:"ServerPerformanceOverTimeMetricBox",props:{servers:{type:Array,required:!1}},setup(h){const{__:o}=$();let d=g({}),a=g(null),p=g(!0),c=g(null);const l=h,m=I(()=>c.value===null||c.value.length<=0||c.value[0]===null||c.value[1]===null);async function w(){p.value=!0;let r={};m.value||(r.from_date=c.value[0],r.to_date=c.value[1]),l.servers&&l.servers.length>0&&(r.servers=l.servers);const _=await F.get(route("admin.graph.server-performance",r));p.value=!1,a.value=_.data,d.value={tooltip:{trigger:"axis",position:function(f){return[f[0],"10%"]}},legend:{},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{type:"time"},yAxis:{type:"value",boundaryGap:[0,"10%"]},dataZoom:[{type:"inside",start:90,end:100,zoomLock:!0},{start:90,end:100}],series:a.value.labels.map((f,C)=>({name:f,type:"line",smooth:!0,symbol:"none",seriesLayoutBy:"column",encode:{y:C+1},emphasis:{focus:"series"}})),dataset:{source:a.value.data}}}O(async()=>{await w()});const D=[{text:o("Today"),onClick(){const r=new Date;return[y(r),v(r)]}},{text:o("Yesterday"),onClick(){const r=M(new Date,1);return[y(r),v(r)]}},{text:o("Last 7 Days"),onClick(){const r=new Date,_=M(r,7);return[y(_),v(r)]}},{text:o("Last 30 Days"),onClick(){const r=new Date,_=M(r,30);return[y(_),v(r)]}},{text:o("This Month"),onClick(){const r=new Date,_=B(r);return[y(_),v(r)]}},{text:o("Last Month"),onClick(){const r=new Date,_=B(A(r,1)),f=z(A(r,1));return[y(_),v(f)]}},{text:o("This Year"),onClick(){const r=new Date,_=Y(r);return[y(_),v(r)]}}];return(r,_)=>(x(),L(t(P),{class:"w-full h-full"},{default:b(()=>[n(t(S),{class:"p-4 space-y-6"},{default:b(()=>[s("div",Z,[s("h3",K,[n(u,{name:"cpu",class:"w-6 mr-2"}),i(" "+e(t(o)("Performance over time")),1)]),n(t(U),{value:t(c),"onUpdate:value":_[0]||(_[0]=f=>T(c)?c.value=f:c=f),type:"date",range:"",placeholder:t(o)("View for date range"),"input-class":"block w-full p-2 text-sm border border-input rounded-md bg-background text-foreground placeholder:text-muted-foreground focus:border-primary focus:ring-1 focus:ring-ring",shortcuts:D,onChange:_[1]||(_[1]=f=>w())},null,8,["value","placeholder"])]),n(V,{options:t(d),height:"350px",loading:t(p),autoresize:!0},null,8,["options","loading"])]),_:1})]),_:1}))}},Q={class:"flex"},X={class:"font-extrabold text-foreground flex mt-2 items-center"},ss={key:0,class:"h-80 flex justify-center items-center"},ts={key:1,class:"m-0 p-0"},es={class:"table-auto min-w-full text-sm dark:text-foreground text-foreground"},as={class:"border-b border-border"},rs={scope:"col",class:"text-left p-2"},os={scope:"col",class:"text-left p-2"},ls={scope:"col",class:"text-left p-2"},ns={scope:"col",class:"text-left p-2"},_s={class:"p-2 flex"},cs={class:"p-2"},ds={class:"p-2"},is={class:"p-2"},us={class:"p-2"},ps={class:"p-2 flex"},ms={class:"p-2"},fs={class:"p-2"},hs={class:"p-2"},ys={class:"p-2"},vs={class:"p-2 flex"},gs={class:"p-2"},xs={class:"p-2"},bs={class:"p-2"},ws={class:"p-2"},ks={class:"p-2 flex"},Ms={class:"p-2"},Ls={class:"p-2"},Ds={class:"p-2"},Bs={class:"p-2"},As={class:"p-2 flex"},Os={class:"p-2"},$s={class:"p-2"},Ps={class:"p-2"},Ss={class:"p-2"},Cs={class:"p-2 flex"},Is={class:"p-2"},Ts={class:"p-2"},Fs={class:"p-2"},js={class:"p-2"},Ns={class:"p-2 flex"},Gs={class:"p-2"},Rs={class:"p-2"},Vs={class:"p-2"},Us={class:"p-2"},Ys={class:"p-2 flex"},qs={class:"p-2"},zs={class:"p-2"},Es={class:"p-2"},Hs={class:"p-2"},Ws={class:"p-2 flex"},Zs={class:"p-2"},Ks={class:"p-2"},Js={class:"p-2"},Qs={class:"p-2"},Xs={__name:"ServerIntelPerformanceNumbersBox",props:{servers:{type:Array,required:!1}},setup(h){const{secondsToHMS:o}=q(),d=h;let a=g(null),p=g(!0);async function c(){p.value=!0;let l={};d.servers&&d.servers.length>0&&(l.servers=d.servers);const m=await axios.get(route("admin.intel.server.performance.numbers",l));p.value=!1,a.value=m.data.numbers}return O(async()=>{await c()}),(l,m)=>(x(),k("div",Q,[n(t(P),{class:"w-full h-full"},{default:b(()=>[n(t(S),{class:"p-4"},{default:b(()=>[s("h3",X,[n(u,{name:"calculator",class:"w-6 mr-2"}),i(" "+e(l.__("Numbers")),1)]),t(p)?(x(),k("div",ss,[n(E,{loading:t(p)},null,8,["loading"])])):(x(),k("div",ts,[s("table",es,[s("thead",as,[s("tr",null,[m[0]||(m[0]=s("th",{scope:"col",class:"text-left p-2"},null,-1)),s("th",rs,e(l.__("Last 24 hours")),1),s("th",os,e(l.__("Last 7 days")),1),s("th",ls,e(l.__("Last 30 days")),1),s("th",ns,e(l.__("Last 3 months")),1)])]),s("tbody",null,[s("tr",null,[s("td",_s,[n(u,{name:"users",class:"w-5 text-success-500 mr-1"}),i(" "+e(l.__("Peak Online Players")),1)]),s("td",cs,e(t(a).max_players.last_24h),1),s("td",ds,e(t(a).max_players.last_7days),1),s("td",is,e(t(a).max_players.last_30days),1),s("td",us,e(t(a).max_players.last_90days),1)]),s("tr",null,[s("td",ps,[n(u,{name:"finger-print",class:"w-5 text-primary mr-1"}),i(" "+e(l.__("Avg Player Session Length")),1)]),s("td",ms,e(t(o)(t(a).player_avg_session_length.last_24h,!0)),1),s("td",fs,e(t(o)(t(a).player_avg_session_length.last_7days,!0)),1),s("td",hs,e(t(o)(t(a).player_avg_session_length.last_30days,!0)),1),s("td",ys,e(t(o)(t(a).player_avg_session_length.last_90days,!0)),1)]),s("tr",null,[s("td",vs,[n(u,{name:"moon-outline",class:"w-5 text-foreground mr-1"}),i(" "+e(l.__("Avg Player AFK Time")),1)]),s("td",gs,e(t(o)(t(a).player_avg_afk_time.last_24h,!0)),1),s("td",xs,e(t(o)(t(a).player_avg_afk_time.last_7days,!0)),1),s("td",bs,e(t(o)(t(a).player_avg_afk_time.last_30days,!0)),1),s("td",ws,e(t(o)(t(a).player_avg_afk_time.last_90days,!0)),1)]),s("tr",null,[s("td",ks,[n(u,{name:"joystick",class:"w-5 text-pink-500 mr-1"}),i(" "+e(l.__("Lowest TPS")),1)]),s("td",Ms,e(t(a).low_tps.last_24h),1),s("td",Ls,e(t(a).low_tps.last_7days),1),s("td",Ds,e(t(a).low_tps.last_30days),1),s("td",Bs,e(t(a).low_tps.last_90days),1)]),s("tr",null,[s("td",As,[n(u,{name:"cpu",class:"w-5 text-primary mr-1"}),i(" "+e(l.__("Avg CPU Usage")),1)]),s("td",Os,e(t(a).avg_cpu.last_24h.toFixed(2))+"% ",1),s("td",$s,e(t(a).avg_cpu.last_7days.toFixed(2))+"% ",1),s("td",Ps,e(t(a).avg_cpu.last_30days.toFixed(2))+"% ",1),s("td",Ss,e(t(a).avg_cpu.last_90days.toFixed(2))+"% ",1)]),s("tr",null,[s("td",Cs,[n(u,{name:"ram",class:"w-5 text-orange-500 mr-1"}),i(" "+e(l.__("Avg RAM Usage")),1)]),s("td",Is,e(Math.round(t(a).avg_memory.last_24h/1024))+" MB ",1),s("td",Ts,e(Math.round(t(a).avg_memory.last_7days/1024))+" MB ",1),s("td",Fs,e(Math.round(t(a).avg_memory.last_30days/1024))+" MB ",1),s("td",js,e(Math.round(t(a).avg_memory.last_90days/1024))+" MB ",1)]),s("tr",null,[s("td",Ns,[n(u,{name:"grid",class:"w-5 text-purple-500 mr-1"}),i(" "+e(l.__("Avg Chunks Loaded")),1)]),s("td",Gs,e(Math.round(t(a).avg_chunks.last_24h)),1),s("td",Rs,e(Math.round(t(a).avg_chunks.last_7days)),1),s("td",Vs,e(Math.round(t(a).avg_chunks.last_30days)),1),s("td",Us,e(Math.round(t(a).avg_chunks.last_90days)),1)]),s("tr",null,[s("td",Ys,[n(u,{name:"server",class:"w-5 text-primary mr-1"}),i(" "+e(l.__("Min Free Disk")),1)]),s("td",qs,e(Math.round(t(a).min_free_disk.last_24h/1048576))+" GB ",1),s("td",zs,e(Math.round(t(a).min_free_disk.last_7days/1048576))+" GB ",1),s("td",Es,e(Math.round(t(a).min_free_disk.last_30days/1048576))+" GB ",1),s("td",Hs,e(Math.round(t(a).min_free_disk.last_90days/1048576))+" GB ",1)]),s("tr",null,[s("td",Ws,[n(u,{name:"toggle-off",class:"w-5 text-error-500 mr-1"}),i(" "+e(l.__("Total Restarts")),1)]),s("td",Zs,e(t(a).total_restarts.last_24h),1),s("td",Ks,e(t(a).total_restarts.last_7days),1),s("td",Js,e(t(a).total_restarts.last_30days),1),s("td",Qs,e(t(a).total_restarts.last_90days),1)])])])]))]),_:1})]),_:1})]))}},st={class:"px-10 py-8 mx-auto space-y-4"},tt={class:"flex justify-between items-center"},$t={__name:"Performance",props:{serverList:{type:Object},filters:{type:Object},noIntelForOverWeek:{type:Boolean}},setup(h){var c,l,m;const{__:o}=$(),d=h;let a=(l=(c=d.filters)==null?void 0:c.servers)!=null&&l.length?(m=d.filters)==null?void 0:m.servers[0]:null;const p=[{text:o("Admin"),current:!1},{text:o("Server Intel"),current:!1},{text:o("Performance"),current:!0},{text:d.serverList[a]??o("All Servers"),current:!0}];return(w,D)=>(x(),L(G,null,{default:b(()=>{var r,_;return[n(j,{title:t(o)("Performance - ServerIntel")},null,8,["title"]),s("div",st,[s("div",tt,[n(R,{class:"mt-0","breadcrumb-class":"max-w-none px-0 md:px-0",items:p}),n(H,{"server-list":d.serverList,filters:d.filters},null,8,["server-list","filters"])]),h.noIntelForOverWeek?(x(),L(W,{key:0,variant:"warning"},{default:b(()=>[i(e(t(o)("Server haven't sent Intel data for over 7 days.")),1)]),_:1})):N("",!0),n(J,{servers:(r=h.filters)==null?void 0:r.servers},null,8,["servers"]),n(Xs,{servers:(_=h.filters)==null?void 0:_.servers},null,8,["servers"])])]}),_:1}))}};export{$t as default};
