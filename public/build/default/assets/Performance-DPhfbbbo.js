import{r as v,i as C,j as O,o as x,d as k,a as s,b as n,f as c,t,u as e,L as T,p as $,Q as S,c as M,w as L,_ as I,e as F}from"./app-Dki4Xgqc.js";import{_ as j}from"./AdminLayout-CFqm4BEF.js";import{_ as N}from"./Chart-SO0efPV7.js";import{i as G}from"./index.es-CFQwJFZK.js";import{I as u}from"./Icon-BkRJZ2lS.js";import{s as y,a as R,u as V}from"./AppLayout-BWWjK4BG.js";import{e as f,s as b,a as D,b as B,c as U}from"./subMonths-_RI6gpbJ.js";import{L as Y}from"./LoadingSpinner-CROdtz6T.js";import{_ as q}from"./ServerIntelServerSelector-C6H4Dzud.js";import{_ as z}from"./AlertCard-Ddc2HVzH.js";import"./keyboard-cy_1EvVK.js";import"./open-closed-Dlly78wX.js";import"./useAuthorizable-BmwA-JR-.js";import"./CloudArrowDownIcon-Djsbu1EF.js";import"./index-AdMbT9xc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XSelect-C70vJp1L.js";import"./XMarkIcon-BbX43MdC.js";const E={class:"w-full h-full p-3 space-y-8 bg-white rounded shadow dark:bg-cool-gray-800"},H={class:"flex justify-between"},W={class:"font-extrabold text-gray-800 dark:text-gray-200 flex items-center"},Z={__name:"ServerPerformanceOverTimeMetricBox",props:{servers:{type:Array,required:!1}},setup(m){const{__:r}=$();let p=v({}),a=v(null),i=v(!0),_=v(null);const l=m,g=C(()=>_.value===null||_.value.length<=0||_.value[0]===null||_.value[1]===null);async function w(){i.value=!0;let o={};g.value||(o.from_date=_.value[0],o.to_date=_.value[1]),l.servers&&l.servers.length>0&&(o.servers=l.servers);const d=await S.get(route("admin.graph.server-performance",o));i.value=!1,a.value=d.data,p.value={tooltip:{trigger:"axis",position:function(h){return[h[0],"10%"]}},legend:{},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{type:"time"},yAxis:{type:"value",boundaryGap:[0,"10%"]},dataZoom:[{type:"inside",start:90,end:100,zoomLock:!0},{start:90,end:100}],series:a.value.labels.map((h,P)=>({name:h,type:"line",smooth:!0,symbol:"none",seriesLayoutBy:"column",encode:{y:P+1},emphasis:{focus:"series"}})),dataset:{source:a.value.data}}}O(async()=>{await w()});const A=[{text:r("Today"),onClick(){const o=new Date;return[y(o),f(o)]}},{text:r("Yesterday"),onClick(){const o=b(new Date,1);return[y(o),f(o)]}},{text:r("Last 7 Days"),onClick(){const o=new Date,d=b(o,7);return[y(d),f(o)]}},{text:r("Last 30 Days"),onClick(){const o=new Date,d=b(o,30);return[y(d),f(o)]}},{text:r("This Month"),onClick(){const o=new Date,d=D(o);return[y(d),f(o)]}},{text:r("Last Month"),onClick(){const o=new Date,d=D(B(o,1)),h=U(B(o,1));return[y(d),f(h)]}},{text:r("This Year"),onClick(){const o=new Date,d=R(o);return[y(d),f(o)]}}];return(o,d)=>(x(),k("div",E,[s("div",H,[s("h3",W,[n(u,{name:"cpu",class:"w-6 mr-1"}),c(" "+t(e(r)("Performance over time")),1)]),n(e(G),{value:e(_),"onUpdate:value":d[0]||(d[0]=h=>T(_)?_.value=h:_=h),type:"date",range:"",placeholder:e(r)("View for date range"),"input-class":"block w-full p-2 text-sm border-gray-300 rounded-md focus:border-light-blue-300 focus:ring focus:ring-light-blue-200 focus:ring-opacity-50 dark:bg-cool-gray-900 dark:text-gray-300 dark:border-gray-900",shortcuts:A,onChange:d[1]||(d[1]=h=>w())},null,8,["value","placeholder"])]),n(N,{options:e(p),height:"350px",loading:e(i),autoresize:!0},null,8,["options","loading"])]))}},K={class:"flex"},Q={class:"bg-white dark:bg-cool-gray-800 rounded w-full h-full p-3 shadow"},J={class:"font-extrabold text-gray-800 dark:text-gray-200 flex mt-2 items-center"},X={key:0,class:"h-80 flex justify-center items-center"},ss={key:1,class:"m-0 p-0"},ts={class:"table-auto min-w-full text-sm dark:text-gray-300 text-gray-700"},es={class:"border-b dark:border-gray-700"},as={scope:"col",class:"text-left p-2"},os={scope:"col",class:"text-left p-2"},rs={scope:"col",class:"text-left p-2"},ls={scope:"col",class:"text-left p-2"},ns={class:"p-2 flex"},ds={class:"p-2"},_s={class:"p-2"},cs={class:"p-2"},is={class:"p-2"},us={class:"p-2 flex"},ps={class:"p-2"},hs={class:"p-2"},ms={class:"p-2"},ys={class:"p-2"},fs={class:"p-2 flex"},gs={class:"p-2"},vs={class:"p-2"},xs={class:"p-2"},ks={class:"p-2"},bs={class:"p-2 flex"},ws={class:"p-2"},Ms={class:"p-2"},Ls={class:"p-2"},Ds={class:"p-2"},Bs={class:"p-2 flex"},Os={class:"p-2"},As={class:"p-2"},Ps={class:"p-2"},Cs={class:"p-2"},Ts={class:"p-2 flex"},$s={class:"p-2"},Ss={class:"p-2"},Is={class:"p-2"},Fs={class:"p-2"},js={class:"p-2 flex"},Ns={class:"p-2"},Gs={class:"p-2"},Rs={class:"p-2"},Vs={class:"p-2"},Us={class:"p-2 flex"},Ys={class:"p-2"},qs={class:"p-2"},zs={class:"p-2"},Es={class:"p-2"},Hs={class:"p-2 flex"},Ws={class:"p-2"},Zs={class:"p-2"},Ks={class:"p-2"},Qs={class:"p-2"},Js={__name:"ServerIntelPerformanceNumbersBox",props:{servers:{type:Array,required:!1}},setup(m){const{secondsToHMS:r}=V(),p=m;let a=v(null),i=v(!0);async function _(){i.value=!0;let l={};p.servers&&p.servers.length>0&&(l.servers=p.servers);const g=await axios.get(route("admin.intel.server.performance.numbers",l));i.value=!1,a.value=g.data.numbers}return O(async()=>{await _()}),(l,g)=>(x(),k("div",K,[s("div",Q,[s("h3",J,[n(u,{name:"calculator",class:"w-6 mr-1"}),c(" "+t(l.__("Numbers")),1)]),e(i)?(x(),k("div",X,[n(Y,{loading:e(i)},null,8,["loading"])])):(x(),k("div",ss,[s("table",ts,[s("thead",es,[s("tr",null,[g[0]||(g[0]=s("th",{scope:"col",class:"text-left p-2"},null,-1)),s("th",as,t(l.__("Last 24 hours")),1),s("th",os,t(l.__("Last 7 days")),1),s("th",rs,t(l.__("Last 30 days")),1),s("th",ls,t(l.__("Last 3 months")),1)])]),s("tbody",null,[s("tr",null,[s("td",ns,[n(u,{name:"users",class:"w-5 text-green-500 mr-1"}),c(" "+t(l.__("Peak Online Players")),1)]),s("td",ds,t(e(a).max_players.last_24h),1),s("td",_s,t(e(a).max_players.last_7days),1),s("td",cs,t(e(a).max_players.last_30days),1),s("td",is,t(e(a).max_players.last_90days),1)]),s("tr",null,[s("td",us,[n(u,{name:"finger-print",class:"w-5 text-indigo-500 mr-1"}),c(" "+t(l.__("Avg Player Session Length")),1)]),s("td",ps,t(e(r)(e(a).player_avg_session_length.last_24h,!0)),1),s("td",hs,t(e(r)(e(a).player_avg_session_length.last_7days,!0)),1),s("td",ms,t(e(r)(e(a).player_avg_session_length.last_30days,!0)),1),s("td",ys,t(e(r)(e(a).player_avg_session_length.last_90days,!0)),1)]),s("tr",null,[s("td",fs,[n(u,{name:"moon-outline",class:"w-5 text-gray-500 mr-1"}),c(" "+t(l.__("Avg Player AFK Time")),1)]),s("td",gs,t(e(r)(e(a).player_avg_afk_time.last_24h,!0)),1),s("td",vs,t(e(r)(e(a).player_avg_afk_time.last_7days,!0)),1),s("td",xs,t(e(r)(e(a).player_avg_afk_time.last_30days,!0)),1),s("td",ks,t(e(r)(e(a).player_avg_afk_time.last_90days,!0)),1)]),s("tr",null,[s("td",bs,[n(u,{name:"joystick",class:"w-5 text-pink-500 mr-1"}),c(" "+t(l.__("Lowest TPS")),1)]),s("td",ws,t(e(a).low_tps.last_24h),1),s("td",Ms,t(e(a).low_tps.last_7days),1),s("td",Ls,t(e(a).low_tps.last_30days),1),s("td",Ds,t(e(a).low_tps.last_90days),1)]),s("tr",null,[s("td",Bs,[n(u,{name:"cpu",class:"w-5 text-blue-500 mr-1"}),c(" "+t(l.__("Avg CPU Usage")),1)]),s("td",Os,t(e(a).avg_cpu.last_24h.toFixed(2))+"% ",1),s("td",As,t(e(a).avg_cpu.last_7days.toFixed(2))+"% ",1),s("td",Ps,t(e(a).avg_cpu.last_30days.toFixed(2))+"% ",1),s("td",Cs,t(e(a).avg_cpu.last_90days.toFixed(2))+"% ",1)]),s("tr",null,[s("td",Ts,[n(u,{name:"ram",class:"w-5 text-orange-500 mr-1"}),c(" "+t(l.__("Avg RAM Usage")),1)]),s("td",$s,t(Math.round(e(a).avg_memory.last_24h/1024))+" MB ",1),s("td",Ss,t(Math.round(e(a).avg_memory.last_7days/1024))+" MB ",1),s("td",Is,t(Math.round(e(a).avg_memory.last_30days/1024))+" MB ",1),s("td",Fs,t(Math.round(e(a).avg_memory.last_90days/1024))+" MB ",1)]),s("tr",null,[s("td",js,[n(u,{name:"grid",class:"w-5 text-purple-500 mr-1"}),c(" "+t(l.__("Avg Chunks Loaded")),1)]),s("td",Ns,t(Math.round(e(a).avg_chunks.last_24h)),1),s("td",Gs,t(Math.round(e(a).avg_chunks.last_7days)),1),s("td",Rs,t(Math.round(e(a).avg_chunks.last_30days)),1),s("td",Vs,t(Math.round(e(a).avg_chunks.last_90days)),1)]),s("tr",null,[s("td",Us,[n(u,{name:"server",class:"w-5 text-light-blue-500 mr-1"}),c(" "+t(l.__("Min Free Disk")),1)]),s("td",Ys,t(Math.round(e(a).min_free_disk.last_24h/1048576))+" GB ",1),s("td",qs,t(Math.round(e(a).min_free_disk.last_7days/1048576))+" GB ",1),s("td",zs,t(Math.round(e(a).min_free_disk.last_30days/1048576))+" GB ",1),s("td",Es,t(Math.round(e(a).min_free_disk.last_90days/1048576))+" GB ",1)]),s("tr",null,[s("td",Hs,[n(u,{name:"toggle-off",class:"w-5 text-red-500 mr-1"}),c(" "+t(l.__("Total Restarts")),1)]),s("td",Ws,t(e(a).total_restarts.last_24h),1),s("td",Zs,t(e(a).total_restarts.last_7days),1),s("td",Ks,t(e(a).total_restarts.last_30days),1),s("td",Qs,t(e(a).total_restarts.last_90days),1)])])])]))])]))}},Xs={class:"p-4 mx-auto space-y-4 px-10"},gt={__name:"Performance",props:{serverList:{type:Object},filters:{type:Object},noIntelForOverWeek:{type:Boolean}},setup(m){const r=m;return(p,a)=>(x(),M(j,null,{default:L(()=>{var i,_;return[n(I,{title:p.__("Performance - ServerIntel")},null,8,["title"]),s("div",Xs,[n(q,{title:p.__("Server Performance"),"server-list":r.serverList,filters:r.filters},null,8,["title","server-list","filters"]),m.noIntelForOverWeek?(x(),M(z,{key:0,"title-class":"flex items-center","text-color":"text-orange-800 dark:text-orange-500","border-color":"border-orange-500"},{default:L(()=>[c(t(p.__("Server haven't sent Intel data for over 7 days.")),1)]),_:1})):F("",!0),n(Z,{servers:(i=m.filters)==null?void 0:i.servers},null,8,["servers"]),n(Js,{servers:(_=m.filters)==null?void 0:_.servers},null,8,["servers"])])]}),_:1}))}};export{gt as default};
